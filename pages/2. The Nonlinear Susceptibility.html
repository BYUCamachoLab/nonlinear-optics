
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2. The Nonlinear Susceptibility &#8212; Nonlinear Optics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Overview of Nonlinear Processes" href="3.%20Overview%20of%20Nonlinear%20Processes.html" />
    <link rel="prev" title="1. Atoms in external electric fields" href="1.%20Atomic%20Polarizability.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Nonlinear Optics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Nonlinear Optics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Course Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../schedule.html">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer.html">
   Computer Configuration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1.%20Atomic%20Polarizability.html">
   1. Atoms in external electric fields
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. The Nonlinear Susceptibility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3.%20Overview%20of%20Nonlinear%20Processes.html">
   3. Overview of Nonlinear Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4.%20Coupled%20Wave%20Equations.html">
   4. Coupled Wave Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5.%20Three-Wave%20Mixing.html">
   5. Three-Wave Mixing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6.%20Focused%20Beams.html">
   6. Focused Beams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7.%20Crystal%20Symmetry.html">
   7. Crystal Symmetry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8.%20Nonlinear%20Optics%20in%20Crystals.html">
   8. Nonlinear Optics in Crystals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9.%20Third%20Order%20Nonlinear%20Polarization.html">
   9. Third-order nonlinear polarization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.%20Raman%20Scattering.html">
   10. Introduction to Raman Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.%20Optoacoustic%20Effects.html">
   11. Optoacoustic Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.%20Stimulated%20Brillouin%20Scattering.html">
   12. Stimulated Brillouin Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.%20Optical%20Phase%20Conjugation.html">
   13. Optical Phase Conjugation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.%20Phase%20and%20Group%20Velocities.html">
   14. Phase and Group Velocities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15.%20Dispersion%20in%20Optical%20Pulses.html">
   15. Dispersion in Optical Pulses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.%20Nonlinear%20Differential%20Equations%20for%20Pulsed%20Light.html">
   16. Nonlinear Differential Equations For Pulsed Light
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.%20Combining%20Dispersion%20and%20Nonlinearity%20in%20Optical%20Pulse%20Propagation.html">
   17. Combining Dispersion and Nonlinearity in Optical Pulse Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.%20The%20Quantum%20Mechanical%20Wave%20Function.html">
   18. The Quantum Mechanical Wave Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.%20The%20Density%20Matrix.html">
   19. The Density Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20.%20First%20Order%20Perturbation%20Theory.html">
   20. First Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="21.%20Second%20Order%20Perturbation%20Theory.html">
   21. Second Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22.%20Electromagnetically%20Induced%20Transparency.html">
   22. Electromagnetically Induced Transparency
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/BYUCamachoLab/nonlinear-optics/main?urlpath=tree/book/pages/2. The Nonlinear Susceptibility.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/BYUCamachoLab/nonlinear-optics/blob/main/book/pages/2. The Nonlinear Susceptibility.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics/issues/new?title=Issue%20on%20page%20%2Fpages/2. The Nonlinear Susceptibility.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/pages/2. The Nonlinear Susceptibility.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mass-spring-system-analogy">
   2.1. Mass-Spring System Analogy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   2.2. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   2.3. Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-concrete-nonlinear-optics-example">
   2.4. A concrete nonlinear optics example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   2.5. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-light-from-nonlinear-polarization">
   2.6. Generating light from nonlinear polarization
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The Nonlinear Susceptibility</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mass-spring-system-analogy">
   2.1. Mass-Spring System Analogy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   2.2. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   2.3. Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-concrete-nonlinear-optics-example">
   2.4. A concrete nonlinear optics example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   2.5. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-light-from-nonlinear-polarization">
   2.6. Generating light from nonlinear polarization
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="the-nonlinear-susceptibility">
<h1><span class="section-number">2. </span>The Nonlinear Susceptibility<a class="headerlink" href="#the-nonlinear-susceptibility" title="Permalink to this headline">#</a></h1>
<p>Name:</p>
<p>Total Points: –/100 pts</p>
<p>Extra Credit: –/30 pts</p>
<p>We have already seen that the displacement of the electron cloud relative to the nucleus can be a nonlinear function of an applied electric field.  The most frequently used strategy to express this nonlinear relationship is writing down the resulting polarization of the atoms <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> (which is proportional to the distance from equilibrium) as power series expansion of the external field <span class="math notranslate nohighlight">\(E(t)\)</span> (which is proportion to the external force). Since the electric field can be a function of time, the polarization is also a function of time.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
P(t) &amp; = \epsilon_0 \left[ \chi^{(1)} E(t) + \chi^{(2)} E^2(t) + \chi^{(3)} E^3(t) + \dots \right]  \\
&amp; \equiv P^{(1)}(t) +  P^{(2)}(t) + P^{(3)}(t) + \dots
\end{align}
\end{split}\]</div>
<p>The term <span class="math notranslate nohighlight">\(\chi^{(1)}\)</span> is the linear susceptibility, while <span class="math notranslate nohighlight">\(\chi^{(2)}\)</span> and <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> are the second- and third-order nonlinear susceptibilities.  Since <span class="math notranslate nohighlight">\(P(t) = qr(t)/V\)</span>, this equation means that when an electric field <span class="math notranslate nohighlight">\(E(t)\)</span> is applied over some volume <span class="math notranslate nohighlight">\(V\)</span>, the equilibrium separation between the nucleus and electron cloud will be <span class="math notranslate nohighlight">\(r(t) = P(t)V/q\)</span>.  The susceptibility has units of <span class="math notranslate nohighlight">\((\text{m}/\text{V})^{n-1}\)</span>.</p>
<section id="mass-spring-system-analogy">
<h2><span class="section-number">2.1. </span>Mass-Spring System Analogy<a class="headerlink" href="#mass-spring-system-analogy" title="Permalink to this headline">#</a></h2>
<p>To gain some familiarity with the nonlinear susceptibility in atoms, let’s return to our mass-spring system analogy, recalling that an atom can be modeled as a mass spring system where the restoring force is due to the electric field of the electron cloud.  If the restoring force is proportional to the displacement (Hooke’s law), we have</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
m \ddot{r} = -k_1r
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the mass and <span class="math notranslate nohighlight">\(k_1\)</span> is the Hooke’s law constant (stiffness) of the spring.</p>
<p>This equation has a simple solution:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
r = A\cos(\omega_0t + \phi)
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_0 = \sqrt{k/m}\)</span> is the natural angluar frequency, <span class="math notranslate nohighlight">\(A\)</span> is the amplitude of oscillation, and <span class="math notranslate nohighlight">\(\phi\)</span> is a phase angle.  We incorporate nonlinearity into the system by adding terms to the right hand side that are nonlinear in <span class="math notranslate nohighlight">\(r\)</span>.  For example, let’s add in a force term that is propotional to <span class="math notranslate nohighlight">\(r^2\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
m \ddot{r} = -k_1r + k_2r^2
\end{align}
\]</div>
<p>Let’s see numerically how this affects the motion of the mass.  We’ll solve this differential equation numerically and then plot the position of the mass as a function of time.  We’ll also take the Fourier tranform to see what spectral components are introduced because of the nonlinearity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### UNCOMMENT AND RUN THIS CELL IF USING GOOGLE COLAB</span>
<span class="c1"># !pip install ipympl -q</span>
<span class="c1"># from google.colab import output</span>
<span class="c1"># output.enable_custom_widget_manager()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">ipw</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">blackman</span>
<span class="o">%</span><span class="k">matplotlib</span> widget
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">blackman</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;widget&#39;</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py:2369,</span> in <span class="ni">InteractiveShell.run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2367</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2368</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2369</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2370</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/magics/pylab.py:99,</span> in <span class="ni">PylabMagics.matplotlib</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available matplotlib backends: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">backends_list</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">99</span>     <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">enable_matplotlib</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_show_matplotlib_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3537,</span> in <span class="ni">InteractiveShell.enable_matplotlib</span><span class="nt">(self, gui)</span>
<span class="g g-Whitespace">   </span><span class="mi">3533</span>         <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: Cannot change to a different GUI toolkit: </span><span class="si">%s</span><span class="s1">.&#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">3534</span>                 <span class="s1">&#39; Using </span><span class="si">%s</span><span class="s1"> instead.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">3535</span>         <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">find_gui_and_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3537</span> <span class="n">pt</span><span class="o">.</span><span class="n">activate_matplotlib</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3538</span> <span class="n">configure_inline_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3540</span> <span class="c1"># Now we must activate the gui pylab wants to use, and fix %run to take</span>
<span class="g g-Whitespace">   </span><span class="mi">3541</span> <span class="c1"># plot updates into account</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/pylabtools.py:360,</span> in <span class="ni">activate_matplotlib</span><span class="nt">(backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="c1"># Due to circular imports, pyplot may be only partially initialised</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span> <span class="c1"># when this function runs.</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span> <span class="c1"># So avoid needing matplotlib attribute-lookup to access pyplot.</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="ne">--&gt; </span><span class="mi">360</span> <span class="n">plt</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="o">.</span><span class="n">_needmain</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span> <span class="c1"># We need to detect at runtime whether show() is called by the user.</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span> <span class="c1"># For this, we wrap it into a decorator which adds a &#39;called&#39; flag.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/matplotlib/pyplot.py:277,</span> in <span class="ni">switch_backend</span><span class="nt">(newbackend)</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span> <span class="c1"># Backends are implemented as modules, but &quot;inherit&quot; default method</span>
<span class="g g-Whitespace">    </span><span class="mi">271</span> <span class="c1"># implementations from backend_bases._Backend.  This is achieved by</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span> <span class="c1"># creating a &quot;class&quot; that inherits from backend_bases._Backend and whose</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span> <span class="c1"># body is filled with the module&#39;s globals.</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span> <span class="n">backend_name</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_backend_module_name</span><span class="p">(</span><span class="n">newbackend</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">277</span> <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>     <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span> <span class="n">required_framework</span> <span class="o">=</span> <span class="n">_get_required_interactive_framework</span><span class="p">(</span><span class="n">backend_mod</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/matplotlib/pyplot.py:278,</span> in <span class="ni">switch_backend.&lt;locals&gt;.backend_mod</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span> <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">278</span>     <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/importlib/__init__.py:126,</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>             <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>         <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">126</span> <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1050,</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1027,</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:992,</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:241,</span> in <span class="ni">_call_with_frames_removed</span><span class="nt">(f, *args, **kwds)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1050,</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1027,</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1004,</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;ipympl&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ode</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">dotr</span> <span class="o">=</span> <span class="n">R</span>
    <span class="n">ddotr</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="n">k2</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dotr</span><span class="p">,</span> <span class="n">ddotr</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">k1</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    
    <span class="n">sol</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">R0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">))</span>
    <span class="n">line0</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">fft_sol</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">line1</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_sol</span><span class="p">))</span>

<span class="n">R0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>   
<span class="n">Nt</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tf</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>
<span class="n">fft_fre</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">Nt</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">blackman</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
<span class="n">dummy_sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">dummy_fre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">fft_fre</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">line0</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dummy_sol</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">fft_fre</span><span class="p">,</span> <span class="n">dummy_fre</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, $t$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Position [m]&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency [Hz]&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1E-7</span><span class="p">,</span> <span class="n">Nt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>



<span class="n">ipw</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">k1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">k2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">))</span>
    
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercises">
<h2><span class="section-number">2.2. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(10 pts) What extra frequency components do you notice when <span class="math notranslate nohighlight">\(k_2\)</span> is nonzero?  Why do they appear?</p></li>
<li><p>(20 pts) Modify the numerical simulation of the anharmonic oscillator above to include a third force term that is proportional to the 3rd power of the displacement.  What additional frequency components appear?</p></li>
<li><p>(20 pts) Add a third subplot showing the potential energy of the mass as a function of displacement.  It should look like a parabola when <span class="math notranslate nohighlight">\(k_2=0\)</span>.  Animate it so that you can see how it changes with increasing <span class="math notranslate nohighlight">\(k_2\)</span>.</p></li>
</ol>
<p>So we can see numerically that the nonlinear restoring force introduces extra frequency components in the <em>natural</em> response of the oscillating mass.  From the perspective of potential energy, this means that the potential energy well is no longer parabolic, just like we saw with the Hydrogen atom.  Now what happens if we add an external <em>driving</em> force?  We’ll also include some damping to account for the fact that the mass loses energy when it oscillates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ode</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">dotr</span> <span class="o">=</span> <span class="n">R</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">fd</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ddotr</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="n">k2</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">dotr</span> <span class="o">+</span> <span class="n">F</span><span class="o">/</span><span class="n">m</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dotr</span><span class="p">,</span> <span class="n">ddotr</span><span class="p">]</span> 

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">k1</span> <span class="o">=</span> <span class="mi">4</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    
    <span class="n">sol</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">R0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">))</span>
    <span class="n">line0</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">fft_sol</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">line1</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_sol</span><span class="p">))</span>
    
<span class="n">R0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span> 
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#damping coefficient</span>
<span class="n">fd</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">Nt</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tf</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>
<span class="n">fft_fre</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">Nt</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">blackman</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
<span class="n">dummy_sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">dummy_fre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">fft_fre</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">line0</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dummy_sol</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">fft_fre</span><span class="p">,</span> <span class="n">dummy_fre</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, $t$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Position [m]&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency [Hz]&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1E-7</span><span class="p">,</span> <span class="n">Nt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>



<span class="n">ipw</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">k1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">k2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<p>It turns out that the 2nd order nonlinear restoring force not only adds a frequency response at twice the natural frequency, but it also adds a response at twice the driving frequency!  We know that oscillating electrons produce their own radiation (hence the damping), so if we can make this nonlinearity large enough,  we should be able to detect a doubled frequency component coming from atoms with a second order nonlinear susceptibility.  Note also that the amount of frequency conversion depends on the value of <span class="math notranslate nohighlight">\(k_2\)</span>, and not very much on <span class="math notranslate nohighlight">\(k_1\)</span>.</p>
</section>
<section id="exercise">
<h2><span class="section-number">2.3. </span>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(20 pts) Set the linear and nonlinear restoring force equal to zero,  but leave the driving force.  What does the frequency response look like?  How about with only the nonlinear restoring force?</p></li>
<li><p>(30 pts Extra Credit, harder).  Instead of <span class="math notranslate nohighlight">\(k_1\)</span> and <span class="math notranslate nohighlight">\(k_2\)</span>, use the potential energy model for the Hydrogen atom in the last notebook to see how its electron cloud oscillates when driven by an oscillating electric field.  Can we predict <span class="math notranslate nohighlight">\(\chi^{(1)}\)</span> and <span class="math notranslate nohighlight">\(\chi^{(3)}\)</span> from this?</p></li>
</ol>
</section>
<section id="a-concrete-nonlinear-optics-example">
<h2><span class="section-number">2.4. </span>A concrete nonlinear optics example<a class="headerlink" href="#a-concrete-nonlinear-optics-example" title="Permalink to this headline">#</a></h2>
<p>In 1961, a group of researchers at the University of Michigan focused an optical beam from the newly developed ruby laser (invented the year before) onto a quartz crystal plate, and achieved the first-ever second-harmonic generation.  You can read the original paper here: <a class="reference external" href="https://journals.aps.org/prl/pdf/10.1103/PhysRevLett.7.118">P. A. Franken, A. E. Hill, C. W. Peters, and G. Weinreich
Phys. Rev. Lett. 7, 118 (1961)</a></p>
<p>In their experiment, the electric field of the focused laser oscillated according to <span class="math notranslate nohighlight">\(E = A\cos \omega t\)</span>, with <span class="math notranslate nohighlight">\(A \approx 1000\)</span> V/m and <span class="math notranslate nohighlight">\(\omega = 2\pi \times 432 \text{ rad}/\text{s}\)</span>, corresponding to 694.3 nm.  This sounds like a very large frequency, but it is actually much slower than the natural oscillation frequency of the electrons in the quartz, so the displacement of the electrons pretty much followed the oscillating field.</p>
<p>The displacement of the electrons creates a dipole moment <span class="math notranslate nohighlight">\(p\)</span> per atom, or equivalently a linear polarization of <span class="math notranslate nohighlight">\(P^{(1)} = Np\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the atomic number density of quartz.  Because of their knowledge of the crystal structure of quartz and their previous experiments with piezoelectricy, the researchers hypothesized that
quartz should have a 2nd order nonlinear polarization in addition to the linear term.  Including that nonlinear term, we can write the polarization mathematically as</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
P(t) = \epsilon_0 \left( \chi^{(1)} A\cos\omega t + \chi^{(2)}A^2\cos^2\omega t \right)
\end{align}
\]</div>
<p>The linear suceptibility is related to the refractive index by <span class="math notranslate nohighlight">\(\chi^{(1)} = n^2 - 1\)</span> = 1.37 for quartz, and the 2nd order nonlinear susceptibility of quartz is <span class="math notranslate nohighlight">\(\chi^{(2)}= 0.46\times10^{-12}\text{ m}/\text{V}\)</span>.  The Michigan researchers didn’t know this number at the time, but they suspected something close based on their experience with quartz piezoelectricity.</p>
<p>Putting in these numbers we arrive at</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
P(t) &amp;= \epsilon_0 \left( (1.37)(1000)\cos\omega t + 0.46\times10^{-12}(1000)^2\cos^2\omega t \right)  \\ &amp;= \epsilon_0 \left( 1370\cos\omega t + 0.46\times10^{-6}\frac{1}{2}(1+ \cos2\omega t) \right)
\end{align}
\end{split}\]</div>
<p>Let’s pause and notice a couple things here:</p>
<ol class="simple">
<li><p>The magnitude of the polarization oscillating at <span class="math notranslate nohighlight">\(2\omega\)</span> is about <span class="math notranslate nohighlight">\(10^{10}\)</span> times smaller than the polarization oscillating at <span class="math notranslate nohighlight">\(\omega\)</span>, even with a highly focused laser!</p></li>
<li><p>There is a term that is not oscillating at all!  This is called optical rectification.  Did you see this in the simulations of the mass spring system as well?</p></li>
</ol>
<p>With these numbers they managed to show the first ever frequency doubling of an optical field.  They measured it by looking at the relative intensities on photographic plates.  The input light at 694.3 nm was dark red and the newly generated light at 347.15 nm was dark blue.  In the ultimate irony, when they sent the image of the photographic plate to the journal for publication, the spot corresponding to the doubled frequency was so dim that the editor thought it was a smudge, and so removed it prior to publication!  Check out the publication to see an arrow pointing to a non-existent spot showing the 2nd harmonic generation.</p>
</section>
<section id="id1">
<h2><span class="section-number">2.5. </span>Exercises<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(10 pts) Make a plot of the magnitude of the linear and 2nd order polarization in quartz as a function of electric field strength for quartz.</p></li>
<li><p>(10 pts) The Michigan researchers used a newly developed laser capable of field strengths of 1000 V/m.  Daniel Smalley has a Sprit One Laser from Spectra Physics.  Here’s the datasheet: <a class="reference external" href="https://www.spectra-physics.com/mam/celum/celum_assets/resources/SpiritOne-Datasheet.pdf?3">Spirit One Datasheet</a>.  What kind of of 2nd order polarization in quartz could you get using this laser?  Assume you can focus down to a few microns.</p></li>
<li><p>(10 pts) Most modern frequency doubling commercial products use BBO or LBO crystals instead of quartz.  How much larger is <span class="math notranslate nohighlight">\(\chi^{(2)}\)</span> in these crystals compared to quartz?</p></li>
</ol>
</section>
<section id="generating-light-from-nonlinear-polarization">
<h2><span class="section-number">2.6. </span>Generating light from nonlinear polarization<a class="headerlink" href="#generating-light-from-nonlinear-polarization" title="Permalink to this headline">#</a></h2>
<p>Even though each of the individual atoms in the quartz crystal has an oscillation at <span class="math notranslate nohighlight">\(2\omega\)</span> that is much smaller than that at <span class="math notranslate nohighlight">\(\omega\)</span>, that doesn’t necessarily mean the fields produced by the atoms two frequencies will be in that ratio.  What kind of electric field is produced by the oscillating atoms.  Well, there is an enormous number of atoms in the crystal oscillating back and forth.  The fields from each of these act like a dipole antenna, but when combined can behave like a phased array of antennas  whose fields constructively interfer and emit light in the forward direction.  When this happens, the field produced is <span class="math notranslate nohighlight">\(N\)</span> times larger thn that of any individual atom, and hence the intensity is <span class="math notranslate nohighlight">\(N^2\)</span> times larger!</p>
<p>The forward fields produced at <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(2\omega\)</span> by the atoms will be coupled together by a wave equation.  Which wave equation?  Maxwell’s equations!  In order to find out how much of each frequency is produced, we must solve the Maxwell wave equations, using the nonlinear polarizations instead of the typical linear polarizations you have seen until now.  There are therefore 2 tasks that will comprise most of the course:</p>
<ol class="simple">
<li><p>Find the nonlinear susceptibilities.</p></li>
<li><p>Put them into Maxwell’s equations and solve for the fields produced.</p></li>
</ol>
<p>Lot of special types of effects will be considered.  We’ll give an overview of them in the next notebook.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="1.%20Atomic%20Polarizability.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">1. </span>Atoms in external electric fields</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3.%20Overview%20of%20Nonlinear%20Processes.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Overview of Nonlinear Processes</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr. Ryan Camacho<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>