
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1. Atoms in external electric fields &#8212; Nonlinear Optics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. The Nonlinear Susceptibility" href="2.%20The%20Nonlinear%20Susceptibility.html" />
    <link rel="prev" title="Computer Configuration" href="../computer.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Nonlinear Optics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Nonlinear Optics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Course Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../schedule.html">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer.html">
   Computer Configuration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Atoms in external electric fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.%20The%20Nonlinear%20Susceptibility.html">
   2. The Nonlinear Susceptibility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3.%20Overview%20of%20Nonlinear%20Processes.html">
   3. Overview of Nonlinear Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4.%20Coupled%20Wave%20Equations.html">
   4. Coupled Wave Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5.%20Three-Wave%20Mixing.html">
   5. Three-Wave Mixing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6.%20Focused%20Beams.html">
   6. Focused Beams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7.%20Crystal%20Symmetry.html">
   7. Crystal Symmetry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8.%20Nonlinear%20Optics%20in%20Crystals.html">
   8. Nonlinear Optics in Crystals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9.%20Third%20Order%20Nonlinear%20Polarization.html">
   9. Third-order nonlinear polarization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.%20Raman%20Scattering.html">
   10. Introduction to Raman Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.%20Optoacoustic%20Effects.html">
   11. Optoacoustic Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.%20Stimulated%20Brillouin%20Scattering.html">
   12. Stimulated Brillouin Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.%20Optical%20Phase%20Conjugation.html">
   13. Optical Phase Conjugation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.%20Phase%20and%20Group%20Velocities.html">
   14. Phase and Group Velocities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15.%20Dispersion%20in%20Optical%20Pulses.html">
   15. Dispersion in Optical Pulses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.%20Nonlinear%20Differential%20Equations%20for%20Pulsed%20Light.html">
   16. Nonlinear Differential Equations For Pulsed Light
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.%20Combining%20Dispersion%20and%20Nonlinearity%20in%20Optical%20Pulse%20Propagation.html">
   17. Combining Dispersion and Nonlinearity in Optical Pulse Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.%20The%20Quantum%20Mechanical%20Wave%20Function.html">
   18. The Quantum Mechanical Wave Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.%20The%20Density%20Matrix.html">
   19. The Density Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20.%20First%20Order%20Perturbation%20Theory.html">
   20. First Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="21.%20Second%20Order%20Perturbation%20Theory.html">
   21. Second Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22.%20Electromagnetically%20Induced%20Transparency.html">
   22. Electromagnetically Induced Transparency
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/BYUCamachoLab/nonlinear-optics/main?urlpath=tree/book/pages/1. Atomic Polarizability.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/BYUCamachoLab/nonlinear-optics/blob/main/book/pages/1. Atomic Polarizability.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics/issues/new?title=Issue%20on%20page%20%2Fpages/1. Atomic Polarizability.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/pages/1. Atomic Polarizability.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-polarizability">
   1.1. Atomic polarizability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#magnitude-of-displacement-linear-approximation">
   1.2. Magnitude of displacement: Linear Approximation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   1.3. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#magnitude-of-displacement-hydrogen-atom">
   1.4. Magnitude of displacement: Hydrogen Atom
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   1.5. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1.6. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extra-credit-opportunity">
   1.7. Extra Credit Opportunity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#closing-thought-what-does-polarizability-have-to-do-with-optics">
   1.8. Closing thought: what does polarizability have to do with optics?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-material-not-required">
   1.9. Bonus Material (Not Required)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mega-bonus-opportunity">
   1.10. Mega-Bonus Opportunity
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Atoms in external electric fields</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-polarizability">
   1.1. Atomic polarizability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#magnitude-of-displacement-linear-approximation">
   1.2. Magnitude of displacement: Linear Approximation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   1.3. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#magnitude-of-displacement-hydrogen-atom">
   1.4. Magnitude of displacement: Hydrogen Atom
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   1.5. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1.6. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extra-credit-opportunity">
   1.7. Extra Credit Opportunity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#closing-thought-what-does-polarizability-have-to-do-with-optics">
   1.8. Closing thought: what does polarizability have to do with optics?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-material-not-required">
   1.9. Bonus Material (Not Required)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mega-bonus-opportunity">
   1.10. Mega-Bonus Opportunity
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="atoms-in-external-electric-fields">
<h1><span class="section-number">1. </span>Atoms in external electric fields<a class="headerlink" href="#atoms-in-external-electric-fields" title="Permalink to this headline">#</a></h1>
<p>Name:</p>
<p>Total Points: –/100 pts</p>
<p>Extra Credit: –/60 pts</p>
<section id="atomic-polarizability">
<h2><span class="section-number">1.1. </span>Atomic polarizability<a class="headerlink" href="#atomic-polarizability" title="Permalink to this headline">#</a></h2>
<p>A neutral atom contains an equal number of positive and negative charges.  The positve charges are protons in the nucleus, and the negative charges are electrons orbiting the nucleus.  In the absence of any external electromagnetic forces, the electrons orbit the nucleus in such a way that the center of charge of the electrons is at the same location as the center of charge of the nucleus.   In reality, quantum mechanics tells us that electrons and protons do not have fixed positions, but consist of quantum mechanical wavefunctions.  Protons, because of their higher mass, are much more localized than electrons, which form a “cloud” around the nucleus.</p>
<p>When an external field is applied, the electrons and protons are pushed in opposite directions, leading to a dipole moment:</p>
<div>
<img src="https://github.com/BYUCamachoLab/nonlinear-optics/blob/main/book/images/fig1.1.png?raw=true" width="400px"/>
</div>
<p>The dipole moment can be expressed mathematically as
\begin{align}
\mathbf{p}=qr
\end{align}</p>
<p>where <span class="math notranslate nohighlight">\(q\)</span> is the electric charge and <span class="math notranslate nohighlight">\(r\)</span> is the shifted position of the electron wave function relative to the nucleus. An extremely important quantity in nonlinear optics is the dipole moment per unit volume, or polarization <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> of the material.  If a material has a high polarization, it has many atoms with dipole moments close to one another.</p>
<p>In linear optics, the relative positions of the nucleus and the electron <span class="math notranslate nohighlight">\(r\)</span> varies <em>linearly</em> with the strength of the electric field. If you apply a field twice as strong, the center of the electronic wavefunction moves twice as far away from the nucleus.  This leads to a linear relationship between the dipole moment and the applied electric field:</p>
<p>\begin{align}
\mathbf{p}=\alpha\mathbf{E}_{ext}
\end{align}</p>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is know as the linear polarizability of the atom. In nonlinear optics, we study situations in which the relative positions of the nucleus and the electrons vary <em>nonlinearly</em> with the strength of the applied field.</p>
</section>
<section id="magnitude-of-displacement-linear-approximation">
<h2><span class="section-number">1.2. </span>Magnitude of displacement: Linear Approximation<a class="headerlink" href="#magnitude-of-displacement-linear-approximation" title="Permalink to this headline">#</a></h2>
<p>So how large is the displacement of the nucleus relative to the electric cloud when an electric field is applied? Let’s make an approximation to get an estimate. If we assume a spherically uniform distribution of total electron charge <span class="math notranslate nohighlight">\(q\)</span> over a radius of <span class="math notranslate nohighlight">\(R\)</span>, the charge density  will be equal to</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\rho = \frac{q}{\frac{4}{3}\pi R^3}  
\end{align}
\]</div>
<p>This electron charge distribution will create an electric field inside its interior equal to (using Gauss’s law):</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\mathbf{E}_{cloud}(r) = \frac{1}{4\pi\epsilon_0}\frac{qr}{R^3}
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the position relative to the center of the sphere. Notice that this electric field is <em>linear</em> in <span class="math notranslate nohighlight">\(r\)</span>.  That means that the nucleus will feel a restoring force proportional to its displacement, just like a mass on a spring.</p>
<p>Suppose that as a result of the external field, the nucleus moves by an amount <span class="math notranslate nohighlight">\(d\)</span> with respect to the center of the electron cloud.  The nucleus will feel a restoring force from the electric force from the cloud equal to</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\mathbf{F}_{cloud} = q\mathbf{E}_{cloud}(d) = \frac{1}{4\pi\epsilon_0}\frac{q^2d}{R^3}
\end{align}
\]</div>
<p>In equlibrium, this force <span class="math notranslate nohighlight">\(\mathbf{F}_{cloud}\)</span> is equal to the force applied by the external field <span class="math notranslate nohighlight">\(q\mathbf{E}_{ext}\)</span>.  So we have</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
q\mathbf{E}_{ext} = \frac{1}{4\pi\epsilon_0}\frac{q^2d}{R^3}
\end{align}
\]</div>
<p>and therefore</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
d = \frac{4\pi\epsilon_0R^3}{q} \mathbf{E}_{ext} 
\end{align}
\]</div>
<p>and the electronic polarizability is</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\alpha = qd/\mathbf{E}_{ext} = 4\pi\epsilon_0R^3
\end{align}
\]</div>
<p>Real atoms of course do not have perfectly spherical charge distributions, but this approximation yields polarizabilities that are quite close to measured values for many atoms.  Using this approximation, let’s calculate the linear polarizability of an oxygen atom and get an order of magnitude estimate of the displacement of the electron cloud when an external field is applied:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### UNCOMMENT AND RUN THIS CELL IF USING GOOGLE COLAB</span>
<span class="c1"># !pip install ipympl -q</span>
<span class="c1"># from google.colab import output</span>
<span class="c1"># output.enable_custom_widget_manager()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import python packages we&#39;ll use</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1">#import NumPy package.  Did you know Travis Oliphant, former BYU ECE faculty, wrote NumPy? </span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1">#get physical constants like pi and c</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>  <span class="c1">#plotting package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">#mpl.rc(&#39;text&#39;, usetex = True)</span>
<span class="o">%</span><span class="k">matplotlib</span> widget
<span class="c1">#mpl.rcParams[&#39;figure.figsize&#39;] = (10,5)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1">#mpl.rc(&#39;text&#39;, usetex = True)</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;widget&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1">#mpl.rcParams[&#39;figure.figsize&#39;] = (10,5)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py:2369,</span> in <span class="ni">InteractiveShell.run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2367</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2368</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2369</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2370</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/magics/pylab.py:99,</span> in <span class="ni">PylabMagics.matplotlib</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available matplotlib backends: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">backends_list</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">99</span>     <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">enable_matplotlib</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_show_matplotlib_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3537,</span> in <span class="ni">InteractiveShell.enable_matplotlib</span><span class="nt">(self, gui)</span>
<span class="g g-Whitespace">   </span><span class="mi">3533</span>         <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: Cannot change to a different GUI toolkit: </span><span class="si">%s</span><span class="s1">.&#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">3534</span>                 <span class="s1">&#39; Using </span><span class="si">%s</span><span class="s1"> instead.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">3535</span>         <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">find_gui_and_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3537</span> <span class="n">pt</span><span class="o">.</span><span class="n">activate_matplotlib</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3538</span> <span class="n">configure_inline_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3540</span> <span class="c1"># Now we must activate the gui pylab wants to use, and fix %run to take</span>
<span class="g g-Whitespace">   </span><span class="mi">3541</span> <span class="c1"># plot updates into account</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/pylabtools.py:360,</span> in <span class="ni">activate_matplotlib</span><span class="nt">(backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="c1"># Due to circular imports, pyplot may be only partially initialised</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span> <span class="c1"># when this function runs.</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span> <span class="c1"># So avoid needing matplotlib attribute-lookup to access pyplot.</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="ne">--&gt; </span><span class="mi">360</span> <span class="n">plt</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="o">.</span><span class="n">_needmain</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span> <span class="c1"># We need to detect at runtime whether show() is called by the user.</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span> <span class="c1"># For this, we wrap it into a decorator which adds a &#39;called&#39; flag.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/matplotlib/pyplot.py:277,</span> in <span class="ni">switch_backend</span><span class="nt">(newbackend)</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span> <span class="c1"># Backends are implemented as modules, but &quot;inherit&quot; default method</span>
<span class="g g-Whitespace">    </span><span class="mi">271</span> <span class="c1"># implementations from backend_bases._Backend.  This is achieved by</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span> <span class="c1"># creating a &quot;class&quot; that inherits from backend_bases._Backend and whose</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span> <span class="c1"># body is filled with the module&#39;s globals.</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span> <span class="n">backend_name</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_backend_module_name</span><span class="p">(</span><span class="n">newbackend</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">277</span> <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>     <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span> <span class="n">required_framework</span> <span class="o">=</span> <span class="n">_get_required_interactive_framework</span><span class="p">(</span><span class="n">backend_mod</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/matplotlib/pyplot.py:278,</span> in <span class="ni">switch_backend.&lt;locals&gt;.backend_mod</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span> <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">278</span>     <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/importlib/__init__.py:126,</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>             <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>         <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">126</span> <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1050,</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1027,</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:992,</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:241,</span> in <span class="ni">_call_with_frames_removed</span><span class="nt">(f, *args, **kwds)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1050,</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1027,</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1004,</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;ipympl&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate electronic polarizibility using spherical electron shell approximation.</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">1e4</span> <span class="c1"># [V/m] external electric field magnitude</span>
<span class="n">Z_Ox</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># oxygen atomic number</span>
<span class="n">R_Ox</span> <span class="o">=</span> <span class="mf">100e-12</span> <span class="c1"># effective atomic radius of Ox atom.  Actual size I looked up is 48 pm.</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">R_Ox</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">Z_Ox</span><span class="p">)</span><span class="o">*</span><span class="n">E</span>
<span class="n">alpha_calc</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">R_Ox</span><span class="o">**</span><span class="mi">3</span> <span class="c1">#calculated polarizability</span>
<span class="n">alpha_calc_cgs</span> <span class="o">=</span> <span class="n">R_Ox</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="mf">1e6</span><span class="o">*</span><span class="mf">1e24</span> <span class="c1">#change to cgs units (most common unit in tables)</span>
<span class="n">alpha_Ox_measured_cgs</span> <span class="o">=</span> <span class="mf">1.31</span> <span class="c1"># 1.31 A^3 in cgs units (value I looked up for Oxygen)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calculated polarizability: </span><span class="si">{:4.2f}</span><span class="s1">, Measured polarizability: </span><span class="si">{:4.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha_calc_cgs</span><span class="p">,</span> <span class="n">alpha_Ox_measured_cgs</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Displacement with external electric field of E = </span><span class="si">{:.2e}</span><span class="s1"> V/m is d = </span><span class="si">{:.2e}</span><span class="s1"> m&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<p>So with an applied field of <span class="math notranslate nohighlight">\(10^4\)</span> V/m in our approximate linear model, the electron cloud (uniform sphere!)  is only displaced about <span class="math notranslate nohighlight">\(10^{-18}\)</span> m. Compared to the atomic radius of approximately <span class="math notranslate nohighlight">\(10^{-10}\)</span> m, this dispacement is very small.  Like ridiculously small, which is why early researchers (pre-1950’s) were not very optimistic about nonlinear optics.  The invention of the laser changed all that…but more on that later.</p>
</section>
<section id="exercises">
<h2><span class="section-number">1.3. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(30 pts) Calculate the electronic polarizibility of Hydrogen using the spherical, uniform electron cloud approximation.  Compare with measured values.  You’ll have to look them up using Google and/or the database of your choice.</p></li>
</ol>
<p>Unlike our approximate model, real atoms don’t have a perfectly spherical charge distribution. Hence, we’d expect some nonlinear displacement if we apply a high enough external field.  Let’s do a calculation using the actual shape of the electron cloud for the simplest atom: Hydrogen.  It turns out that hydrogen gives us a pretty good estimate to how many materials behave.</p>
</section>
<section id="magnitude-of-displacement-hydrogen-atom">
<h2><span class="section-number">1.4. </span>Magnitude of displacement: Hydrogen Atom<a class="headerlink" href="#magnitude-of-displacement-hydrogen-atom" title="Permalink to this headline">#</a></h2>
<p>The actual radial charge distribution <span class="math notranslate nohighlight">\(\rho(r)\)</span> of an electron is proportional to the square of the quantum mechanical wavefunction describing the charge.  For an electron in the Hydrogen 1s state, the wavefunction <span class="math notranslate nohighlight">\(\psi(r)\)</span> and its square <span class="math notranslate nohighlight">\(|\psi(r)|^2\)</span> are:</p>
<div class="math notranslate nohighlight">
\[
\psi(r)=\frac{1}{\sqrt{\pi}a_0^{3/2}}e^{-r/a_0}
\]</div>
<div class="math notranslate nohighlight">
\[
\rho(r) = e|\psi(r)|^2=\frac{e}{\pi a_0^3}e^{-2r/a_0}
\]</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> is the electron charge and <span class="math notranslate nohighlight">\(a_0 = 53.92\)</span> pm is the Bohr radius.</p>
<p>The probability <span class="math notranslate nohighlight">\(P(r)\)</span> of finding the electron in a shell of thickness <span class="math notranslate nohighlight">\(dr\)</span> at a distance <span class="math notranslate nohighlight">\(r\)</span> from the nucleus is given by</p>
<div class="math notranslate nohighlight">
\[
P(r)dr = 4\pi r^2 |\psi(r)|^2 dr 
\]</div>
<p>Let’s plot this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#set up equations for quantum mechanical electron distribution </span>
<span class="n">a0</span> <span class="o">=</span> <span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;Bohr radius&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#get Bohr radius from scipy </span>
<span class="n">r0</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set min radial coordinate.  A little more than 0 to avoid dividing by zero</span>
<span class="n">rf</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set max radial coordinate</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span> <span class="c1">#number of points in r array</span>
<span class="n">dr</span> <span class="o">=</span> <span class="p">(</span><span class="n">rf</span> <span class="o">-</span> <span class="n">r0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1">#dr step size</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">dr</span><span class="p">)</span> <span class="c1">#radial coordinate array</span>
<span class="n">Z</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># atomic number </span>
<span class="n">psi</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span> <span class="c1">#electron density wavefunction</span>
<span class="n">P</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">dr</span> <span class="c1"># radial probability distribution</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot quantum mechanical electron distribution </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">psi</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">psi</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$|\psi(r)|^2$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> <span class="c1">#plot electron density as a function of radial coordinate</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">P</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$P(r)dr$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1">#plot radial distribution function</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$a_0$ = </span><span class="si">{:.2f}</span><span class="s1"> pm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Hydrogen 1s radial electron density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [pm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that the most <em>likely</em> place to find the electron is the Bohr radius <span class="math notranslate nohighlight">\(a_0\)</span> at about 53 pm from the nucleus.  If we like, we can visualize the charge and probability distribution in 2D as an electron cloud:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2D visualization of actual quantum mechanical electron charge distribution </span>

<span class="n">a0</span><span class="o">=</span><span class="mi">1</span>  <span class="c1">#let&#39;s use distance units of a_0 for the plot</span>
<span class="n">r0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set min radial coordinate</span>
<span class="n">rf</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set max radial coordinate</span>


<span class="c1"># function to calculate electron wavefunction</span>
<span class="k">def</span> <span class="nf">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span>

<span class="c1">#function to calculate radial probability distribution</span>
<span class="k">def</span> <span class="nf">rad_dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">Zpsi</span> <span class="o">=</span> <span class="n">psi</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">ZD</span> <span class="o">=</span> <span class="n">rad_dist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>


<span class="n">cmap1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span>
<span class="n">cmap2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">impsi</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Zpsi</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap1</span><span class="p">,</span>
               <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">r0</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">r0</span><span class="p">,</span><span class="n">rf</span><span class="p">],</span>
               <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Zpsi</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;distance in units of $a_0$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;charge distribution $\rho(r)$&#39;</span><span class="p">)</span>

<span class="n">imD</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ZD</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap2</span><span class="p">,</span>
               <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">r0</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">r0</span><span class="p">,</span><span class="n">rf</span><span class="p">],</span>
               <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">ZD</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;distance in units of $a_0$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;radial probability distribution $4\pi r^2 \rho(r)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2><span class="section-number">1.5. </span>Exercises<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(20 pts) What fraction of the electron charge is within a Bohr radius in Hydrogen?  Does this mean our approximate model is really bad?  Why or why not?</p></li>
<li><p>(20 pts) What fraction of the electron charge is inside the nucleus?  Assume a nuclear radius is the diameter of a proton.  Is physics broken if we just showed that the electron has some probability of being found <em>inside</em> the nucleus?</p></li>
</ol>
<p>In order to calculate the restoring force, and hence potential energy of the electron as a function of position, we need to find the electric field resulting from this charge distribution.  To do this we again use Gauss’s law, just like in the spherical approximation:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\int_S \mathbf{E}\cdot \mathbf{dA} = \frac{Q_{enc}}{\epsilon_0} 
\end{align}
\]</div>
<p>Since the 1s state in Hydrogen is radially symmetric, we may find the electric field at any distance <span class="math notranslate nohighlight">\(r\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
E(r) &amp;= \frac{Q_{enc}}{4\pi r^2 \epsilon_0} \\
     &amp;= \frac{1}{4\pi r^2 \epsilon_0}\int_0^r 4\pi x^2\rho(x)dx \\
     &amp;= \frac{e}{\pi r^2 \epsilon_0 a_0^3}\int_0^r x^2e^{-2x/a_0}dx \\ 
     &amp;= \frac{-e}{4\pi r^2\epsilon_0 a_0^2}e^{-2r/a_0}\left(a_0^2 + 2a_0r + 2r^2\right) + \frac{e}{4\pi\epsilon_0 r^2} \\
     &amp;= \frac{e}{4\pi\epsilon_0 r^2} \left[ 1 - e^{-2r/a_0}\left(1 + 2r/a_0 + 2(r/a_0)^2\right) \right]
\end{align}
\end{split}\]</div>
<p>That integral wasn’t too bad,  but we should note that we have Python at our disposal (the whole point of doing this course in Python!), so we can just let Python do the work and numerically integrate.  Let’s do that and compare to the analytic expressions for the enclosed charge and electric field:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write down expressions for enclosed charge as a function of radius and resulting electric field.</span>
<span class="n">a0</span> <span class="o">=</span> <span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;Bohr radius&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#get Bohr radius from scipy </span>
<span class="n">r0</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set min radial coordinate</span>
<span class="n">rf</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set max radial coordinate</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span> <span class="c1">#number of points in r array</span>
<span class="n">dr</span> <span class="o">=</span> <span class="p">(</span><span class="n">rf</span> <span class="o">-</span> <span class="n">r0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1">#dr step size</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">dr</span><span class="p">)</span> <span class="c1">#radial coordinate array</span>
<span class="n">Z</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># atomic number </span>
<span class="n">psi</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span> <span class="c1">#electron density wavefunction</span>
<span class="n">P</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># radial distribution function</span>

<span class="c1">#Numerical calcuations</span>
<span class="n">qenc</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="n">dr</span> <span class="c1">#Calculate charge enclosed at radius r using a cumulative sum.  This is a simple way to integrate in Python, but is not quite as accurate.</span>
<span class="n">A</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#Area of shell at radius r</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">qenc</span><span class="o">/</span><span class="n">epsilon_0</span><span class="o">/</span><span class="n">A</span> <span class="c1">#Electric field at radius r</span>

<span class="c1">#Analytic expressions</span>
<span class="n">qenc_analytic</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a0</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">e</span>
<span class="n">E_analytic</span> <span class="o">=</span> <span class="n">qenc_analytic</span><span class="o">/</span><span class="n">epsilon_0</span><span class="o">/</span><span class="n">A</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot electric field and enclosed charge </span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">qenc</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">qenc</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$Q_</span><span class="si">{enc}</span><span class="s1">(r)$ numeric&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> <span class="c1">#numerically calculated charge enclosed</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">qenc_analytic</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">qenc_analytic</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$Q_</span><span class="si">{enc}</span><span class="s1">(r)$ analytic&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#analytic charge enclosed</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">E</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">E</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$E(r)$ numeric&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1">#plot Electric Field</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">E_analytic</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">E_analytic</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$E(r)$ analytic&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#plot Electric Field</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$a_0$ = </span><span class="si">{:.2f}</span><span class="s1"> pm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Hydrogen 1s enclosed charge and resulting E-field&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [pm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The numeric and analytic expressions match very well, except perhaps right near the origin.  Let’s do some slightly fancier integration using built-in Python integration tools from SciPy to see if we can do better.  While we’re at it, let’s also do some fancy interactive plotting.  This will be a useful Python skill for visualizing things later in the course.  For this example we’ll vary the atomic number Z in the interactive plot to see how things change.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use Scipy integrate function to calculate electric field. Also demonstrate interactive plotting.</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">ipw</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>

<span class="k">def</span> <span class="nf">ode</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">Z</span><span class="p">):</span>
    <span class="n">drho</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="n">a0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">drho</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">Z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    update solution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z</span><span class="p">,))</span>
    <span class="n">Esol</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">epsilon_0</span><span class="o">/</span><span class="n">A</span>
    <span class="n">line0</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">sol</span><span class="o">/</span><span class="n">e</span><span class="p">)</span>
    <span class="n">line1</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">Esol</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Esol</span><span class="p">))</span>
    

<span class="n">rho0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#r = np.logspace(np.log10(r0), np.log10(rf),N) #radial coordinate array</span>
<span class="c1">#A = 4*pi*r**2</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">line0</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Enclosed charge&quot;</span><span class="p">)</span>
<span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;E Numerical&quot;</span><span class="p">)</span>
<span class="n">line3</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">E_analytic</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">E_analytic</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;E Analytic, Z=1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$r$ [pm]&quot;</span><span class="p">)</span>
<span class="c1">#plt.ylabel(&quot;Enclosed Charge [e]&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ipw</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2><span class="section-number">1.6. </span>Exercises<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(30 pts) Add to the interactive plot so that it displays the value of the enclosed charge and the field at the Bohr radius.</p></li>
</ol>
<p>Now we’ve plotted the electric field as a function of distance from the nuclues.  It is <em>very</em> nonlinear!  But as long as the electron doesn’t move too far from the origin, the restoring force will be <em>approximately</em> linear.</p>
<p>Let’s compare this to the linear approximation above in which we assumed a spherical charge distribution.</p>
<p>Note: We’re using the words “linear” and “nonlinear” a lot to get you used to what is actually nonlinear in nonlinear optics (the polarizibility!).</p>
<p>To summarize so far, we have calculated the electric field inside a Hydrogen atom using a linear approximation and the full quantum mechanical wavefunction:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mathbf{E}_{approximate} &amp;= \frac{1}{4\pi\epsilon_0}\frac{er}{R^3} &amp;&amp; \text{Linear}\\
\mathbf{E}_{actual} &amp;= \frac{e}{4\pi\epsilon_0 r^2} \left[ 1 - e^{-2r/a_0}\left(1 + 2r/a_0 + 2(r/a_0)^2\right) \right] &amp;&amp; \text{Nonlinear!}
\end{align}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E_approximate</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">epsilon_0</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="n">a0</span><span class="o">**</span><span class="mi">3</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">E_analytic</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$E(r)$ actual&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="c1">#plot Electric Field</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">E_approximate</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$E(r)$ approximate&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="c1">#plot Electric Field</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1e12</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$a_0$ = </span><span class="si">{:.2f}</span><span class="s1"> pm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">))</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [pm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5e12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [pm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E(r)$ [V/m]&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>That’s <em>close</em> but not perfect.  If we do a power series expansion of the equation for the analytic field, we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
 E(r) &amp;= \frac{e}{4\pi\epsilon_0 r^2} \left[ 1 - e^{-2r/a_0}\left(1 + 2r/a_0 + 2(r/a_0)^2\right) \right]  \\
 &amp;= \frac{e}{3\pi \epsilon_0 a_0^3}r - \frac{e}{2\pi\epsilon_0 a_0^4}r^2 + \frac{2e}{5\pi \epsilon_0 a_0^5}r^3 - \frac{2e}{9\pi\epsilon_0 a_0^6}r^4 + \frac{2e}{21\pi \epsilon a_0^7}r^5 + \dots -
\end{align}
\end{split}\]</div>
<p>Looking at the linear term in the expansion, we find that the linear polarizibility of Hydrogen is</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\alpha = 3\pi\epsilon_0a_0^3.
\end{align}
\]</div>
<p>So our solid sphere model for the electric charge was off by a factor of <span class="math notranslate nohighlight">\(4/3\)</span> for the linear polarization, but still pretty close!</p>
<p>Let’s plot the correct value so that we have a satisfying pretty picture with linear and nonlinear curves:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E_taylor</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">epsilon_0</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="n">a0</span><span class="o">**</span><span class="mi">3</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">E_analytic</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$E(r)$ actual&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="c1">#plot Electric Field</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">E_taylor</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$E(r)$ power series&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="c1">#plot Electric Field</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1e12</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$a_0$ = </span><span class="si">{:.2f}</span><span class="s1"> pm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">))</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [pm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5e12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [pm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E(r)$ [V/m]&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Ahh…that’s better.  Note that the linear approximate devatiates significantly after about 10 pm from the orgin, where the electric field is approximately <span class="math notranslate nohighlight">\(10^{11}\)</span> V/m.  This means we need a non-resonant external field of around <span class="math notranslate nohighlight">\(10^{11}\)</span> V/m to observe nonlinear effects! Fortunately, the oscillating electric fields in lasers can be tuned to be resonant with the oscillating motion of the proton-electron oscillating dipole moment, and hence not require such ridiculously large fields.</p>
<p>To further cement the analogy to mass-spring systems, let’s also plot the potential energy <span class="math notranslate nohighlight">\(eV(r)\)</span>, just like it’s done in mass-spring systems.  Recall that the potential <span class="math notranslate nohighlight">\(V(r)\)</span> is simply the line integral of the electric field from some point with zero potential energy (infinity) to the point in question.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r0</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set min radial coordinate</span>
<span class="n">rf</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">a0</span> <span class="c1">#set max radial coordinate.  Set really big so that potential is zero at this point.</span>
<span class="n">N</span><span class="o">=</span><span class="mi">50000</span> <span class="c1">#number of points in r array</span>
<span class="n">dr</span> <span class="o">=</span> <span class="p">(</span><span class="n">rf</span> <span class="o">-</span> <span class="n">r0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1">#dr step size</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span><span class="n">rf</span><span class="p">,</span><span class="n">dr</span><span class="p">)</span> <span class="c1">#radial coordinate array    </span>



<span class="k">def</span> <span class="nf">ode</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="n">qenc_analytic</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a0</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">e</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">E_analytic</span> <span class="o">=</span> <span class="n">qenc_analytic</span><span class="o">/</span><span class="n">epsilon_0</span><span class="o">/</span><span class="n">A</span>
    <span class="n">dV</span> <span class="o">=</span> <span class="n">E_analytic</span>
    <span class="k">return</span> <span class="n">dV</span>




<span class="n">V0</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="c1">#note we integrate from infinity to zero by flipping r</span>
<span class="n">U_taylor</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">epsilon_0</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">a0</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">sol</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Actual&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">sol</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">U_taylor</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Linear Approximation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span><span class="n">U_taylor</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$a_0$ = </span><span class="si">{:.2f}</span><span class="s1"> pm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a0</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$r$ [pm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$U(r)$ [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The the potential energy for the linear approximation is a perfect parabola, just like in a mass-spring system.  The potential energy for the actual system is approximately the same for small displacements, but much lower for larger displacements. Notice also that we recover the ground state energy of a Hydrogen atom of -13.6 eV.</p>
</section>
<section id="extra-credit-opportunity">
<h2><span class="section-number">1.7. </span>Extra Credit Opportunity<a class="headerlink" href="#extra-credit-opportunity" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(20 pts) Can you write code that animates a “ball” in these potential wells, sloshing back an forth?</p></li>
<li><p>(40 pts, Much harder) For those who have taken quantum optics, can you solve the Schrodinger equation in the energy basis and plot the eigenfunctions for a linear and nonlinear harmonic oscillator with these potentials?  Ignore radial coordinates for now and just assume a 1D potential. What is the spacing between the eigenvalues (energies) in each case?</p></li>
</ol>
</section>
<section id="closing-thought-what-does-polarizability-have-to-do-with-optics">
<h2><span class="section-number">1.8. </span>Closing thought: what does polarizability have to do with optics?<a class="headerlink" href="#closing-thought-what-does-polarizability-have-to-do-with-optics" title="Permalink to this headline">#</a></h2>
<p>So we now know that in general the atomic polarization can be nonlinear.  But what does inducing a dipole moment with an external electric field have to to with optics?  A couple of things are worth pointing out:</p>
<ol class="simple">
<li><p>First, for most of the nonlinear optics processes we will study, the external electric field <em>is</em> an optical field (often a laser).  This optical field oscillates at optical frequencies (100’s of THz), and hence the relative position of the electron cloud and nucleus can oscillate at optical frequencies.</p></li>
<li><p>Second, dipoles produce electric fields themselves.</p></li>
</ol>
</section>
<section id="bonus-material-not-required">
<h2><span class="section-number">1.9. </span>Bonus Material (Not Required)<a class="headerlink" href="#bonus-material-not-required" title="Permalink to this headline">#</a></h2>
<p>Remeber how we expanded the electric field in a power series?  Let’s extend that a bit:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
 E(r) &amp;= \frac{e}{4\pi\epsilon_0 r^2} \left[ 1 - e^{-2r/a_0}\left(1 + 2r/a_0 + 2(r/a_0)^2\right) \right]  \\
 &amp;= \frac{e}{3\pi \epsilon_0 a_0^3}r - \frac{e}{2\pi\epsilon_0 a_0^4}r^2 + \frac{2e}{5\pi \epsilon_0 a_0^5}r^3 - \frac{2e}{9\pi\epsilon_0 a_0^6}r^4 + \frac{2e}{21\pi \epsilon a_0^7}r^5 + \dots -  \\
&amp;= \frac{e}{4\pi\epsilon_0 a_0^2}\left[ \frac{4}{3}\frac{r}{a_0} - \frac{2}{1}\left(\frac{r}{a_0}\right)^2 + \frac{8}{5}\left(\frac{r}{a_0}\right)^3 + \dots -\right]   \\
&amp;= \frac{e}{4\pi\epsilon_0 a_0^2} \sum_0^\infty \left(\frac{-r}{a_0}\right)^n \left[2^{n+1} \left( \frac{-1}{n!} + \frac{2}{(n+1)!} +\frac{-2}{(n+2)!} \right)\right]  \\
\end{align}
\end{split}\]</div>
<p>We might naturally wonder whether we could use this power series expansion can help us find the correct terms for 2nd, 3rd, and higher order nonlinearities.  It turns out the answer is no.  Why?</p>
<p>We have only expanded the field for positive values of <span class="math notranslate nohighlight">\(r\)</span>, and so our Taylor expansion is not valid for negative values of <span class="math notranslate nohighlight">\(r\)</span>.  So all higher terms except the linear term are being “influenced” by these negative values.  Say what?   We can think about it this way: in writing the electric field as a function of <span class="math notranslate nohighlight">\(r\)</span>, we have implicitly neglected the fact that the electric field always points radially <em>outwards</em> from the origin.  So any line plot through the origin of the field projected onto one direction should be an odd function. The Taylor series expansion of that field should therefore only contain odd powers of <span class="math notranslate nohighlight">\(r\)</span>, but our Taylor expansion clearly has <em>even</em> terms, so it can’t be used to find the nonlinear forces acting on an electron oscillating about the origin.</p>
</section>
<section id="mega-bonus-opportunity">
<h2><span class="section-number">1.10. </span>Mega-Bonus Opportunity<a class="headerlink" href="#mega-bonus-opportunity" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>Find an odd representation of the electric field of a Hydrogen atom that can be expanded in a Taylor series that accurately gives the nonliear polarization.  I have not seen this in the literature, so it might be worth a peer-review publication if you can figure it out.  Here is the beginning of an attempt I’ve made:</p></li>
</ol>
<p>We know the positive values are correct, so we can numerically make an odd function that is correct simply by negating the field for negative values of <span class="math notranslate nohighlight">\(r\)</span>.  The strategy is then to find a power series expansion that converges within some radius and/or an analytic function for that field.  Here’s a numerical approximation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qenc_analytic</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a0</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">e</span>
<span class="n">A</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
<span class="n">E_analytic</span> <span class="o">=</span> <span class="n">qenc_analytic</span><span class="o">/</span><span class="n">epsilon_0</span><span class="o">/</span><span class="n">A</span>
<span class="n">rodd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">))</span><span class="o">/</span><span class="n">a0</span> <span class="c1">#Create an r-array that has negative and positive values</span>
<span class="n">Eodd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="o">-</span><span class="n">E_analytic</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">E_analytic</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">E_analytic</span><span class="p">)</span> <span class="c1"># Make E negative for negative r</span>

<span class="c1">#Plot the electric field</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rodd</span><span class="o">/</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">Eodd</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use SciPy&#39;s interpolate functions to fund an approximate Taylor expansion.  </span>
<span class="c1"># Look for an expansion that has very small even terms</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">approximate_taylor_polynomial</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="n">Ef</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">rodd</span><span class="p">,</span><span class="n">Eodd</span><span class="p">)</span> <span class="c1"># Generate an interpolation function</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rodd</span><span class="p">,</span><span class="n">Ef</span><span class="p">(</span><span class="n">rodd</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">degree</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">]:</span>
    <span class="n">E_taylor</span> <span class="o">=</span> <span class="n">approximate_taylor_polynomial</span><span class="p">(</span><span class="n">Ef</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">degree</span><span class="p">)</span> <span class="c1">#the scale parameter is very sensitive   </span>
    <span class="n">E_taylor_trunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">E_taylor</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">::</span><span class="mi">1</span><span class="p">])</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rodd</span><span class="p">,</span> <span class="n">E_taylor</span><span class="p">(</span><span class="n">rodd</span><span class="p">),</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;degree=</span><span class="si">{</span><span class="n">degree</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1">#plt.plot(rodd, E_taylor_trunc(rodd), linestyle=&#39;--&#39;,label=f&quot;degree={degree} truncated&quot;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">Polynomial</span><span class="p">(</span><span class="n">E_taylor_trunc</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">Polynomial</span><span class="p">(</span><span class="n">E_taylor</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Look at just the first few terms.  </span>
<span class="n">E_taylor_trunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">Polynomial</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">E_taylor</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">::</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">Polynomial</span><span class="p">(</span><span class="n">E_taylor_trunc</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../computer.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Computer Configuration</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2.%20The%20Nonlinear%20Susceptibility.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>The Nonlinear Susceptibility</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr. Ryan Camacho<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>