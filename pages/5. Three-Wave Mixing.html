
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. Three-Wave Mixing &#8212; Nonlinear Optics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Focused Beams" href="6.%20Focused%20Beams.html" />
    <link rel="prev" title="4. Coupled Wave Equations" href="4.%20Coupled%20Wave%20Equations.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Nonlinear Optics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Nonlinear Optics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Course Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../schedule.html">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer.html">
   Computer Configuration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1.%20Atomic%20Polarizability.html">
   1. Atoms in external electric fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.%20The%20Nonlinear%20Susceptibility.html">
   2. The Nonlinear Susceptibility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3.%20Overview%20of%20Nonlinear%20Processes.html">
   3. Overview of Nonlinear Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4.%20Coupled%20Wave%20Equations.html">
   4. Coupled Wave Equations
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5. Three-Wave Mixing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6.%20Focused%20Beams.html">
   6. Focused Beams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7.%20Crystal%20Symmetry.html">
   7. Crystal Symmetry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8.%20Nonlinear%20Optics%20in%20Crystals.html">
   8. Nonlinear Optics in Crystals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9.%20Third%20Order%20Nonlinear%20Polarization.html">
   9. Third-order nonlinear polarization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.%20Raman%20Scattering.html">
   10. Introduction to Raman Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.%20Optoacoustic%20Effects.html">
   11. Optoacoustic Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.%20Stimulated%20Brillouin%20Scattering.html">
   12. Stimulated Brillouin Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.%20Optical%20Phase%20Conjugation.html">
   13. Optical Phase Conjugation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.%20Phase%20and%20Group%20Velocities.html">
   14. Phase and Group Velocities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15.%20Dispersion%20in%20Optical%20Pulses.html">
   15. Dispersion in Optical Pulses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.%20Nonlinear%20Differential%20Equations%20for%20Pulsed%20Light.html">
   16. Nonlinear Differential Equations For Pulsed Light
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.%20Combining%20Dispersion%20and%20Nonlinearity%20in%20Optical%20Pulse%20Propagation.html">
   17. Combining Dispersion and Nonlinearity in Optical Pulse Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.%20The%20Quantum%20Mechanical%20Wave%20Function.html">
   18. The Quantum Mechanical Wave Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.%20The%20Density%20Matrix.html">
   19. The Density Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20.%20First%20Order%20Perturbation%20Theory.html">
   20. First Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="21.%20Second%20Order%20Perturbation%20Theory.html">
   21. Second Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22.%20Electromagnetically%20Induced%20Transparency.html">
   22. Electromagnetically Induced Transparency
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/BYUCamachoLab/nonlinear-optics/main?urlpath=tree/book/pages/5. Three-Wave Mixing.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/BYUCamachoLab/nonlinear-optics/blob/main/book/pages/5. Three-Wave Mixing.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics/issues/new?title=Issue%20on%20page%20%2Fpages/5. Three-Wave Mixing.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/pages/5. Three-Wave Mixing.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-three-wave-mixing-process">
   5.1. General Three-wave Mixing Process
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   5.2. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-3-wave-mixing">
   5.3. General 3-wave mixing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   5.4. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quasi-phase-matching">
   5.5. Quasi Phase Matching
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   5.6. Exercises
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Three-Wave Mixing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-three-wave-mixing-process">
   5.1. General Three-wave Mixing Process
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   5.2. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-3-wave-mixing">
   5.3. General 3-wave mixing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   5.4. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quasi-phase-matching">
   5.5. Quasi Phase Matching
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   5.6. Exercises
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="three-wave-mixing">
<h1><span class="section-number">5. </span>Three-Wave Mixing<a class="headerlink" href="#three-wave-mixing" title="Permalink to this headline">#</a></h1>
<p>Name:</p>
<p>Total Points: –/100 pts</p>
<p>Extra Credit: –/40 pts</p>
<p>In the last notebook, we derived the wave equation for nonlinear interactions and worked through the specific example of second harmonic generation. Here’s the wave equation again:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\frac{\partial E_n(z)}{\partial z}  &amp;= j\frac{\omega_n}{2 \epsilon_0 c n_n} P_n^{(NL)}(z)
\end{align}
\]</div>
<p>In this notebook, we’ll use the same wave equation to investigate general three-wave mixing processes.</p>
<section id="general-three-wave-mixing-process">
<h2><span class="section-number">5.1. </span>General Three-wave Mixing Process<a class="headerlink" href="#general-three-wave-mixing-process" title="Permalink to this headline">#</a></h2>
<p>The first task is to find the nonlinear polarization.   We have 3 fields at frequencies <span class="math notranslate nohighlight">\(\omega_1\)</span>, <span class="math notranslate nohighlight">\(\omega_2\)</span>, and <span class="math notranslate nohighlight">\(\omega_3\)</span>, labeled in order of increasing frequency.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
E(z,t) = E_1(z)e^{j(k_1z - \omega_1 t)} + E_2(z)e^{j(k_2z - \omega_2 t)} + E_3(z)e^{j(k_3z - \omega_3 t)}
\end{align}
\]</div>
<p>The second order nonlinear polarization is produced by <span class="math notranslate nohighlight">\(\chi^{(2)}\)</span> and has the form:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
P^{(NL)}(z, t) = \epsilon_0 \chi^{(2)}E^2(z,t).  
\end{align}
\]</div>
<p>Let’s take the square of the electric field using SymPy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### UNCOMMENT AND RUN THIS CELL IF USING GOOGLE COLAB</span>
<span class="c1"># !pip install ipympl -q</span>
<span class="c1"># from google.colab import output</span>
<span class="c1"># output.enable_custom_widget_manager()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1">#import sympy</span>
<span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">E3</span><span class="p">,</span> <span class="n">omega1</span><span class="p">,</span> <span class="n">omega2</span><span class="p">,</span> <span class="n">omega3</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;E1, E2, E3, omega_1, omega_2, omega_3, k_1, k_2, k_3, z, t&#39;</span><span class="p">)</span>
<span class="n">Esq</span> <span class="o">=</span> <span class="p">((</span><span class="n">E1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega1</span><span class="o">*</span><span class="n">t</span><span class="p">))</span><span class="o">+</span> <span class="n">functions</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega1</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
      <span class="o">+</span> <span class="n">E2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">k2</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span><span class="o">+</span> <span class="n">functions</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">k2</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
      <span class="o">+</span> <span class="n">E3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">k3</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="p">(</span><span class="n">omega1</span><span class="o">+</span><span class="n">omega2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">))</span><span class="o">+</span> <span class="n">functions</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">k3</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="p">(</span><span class="n">omega1</span><span class="o">+</span><span class="n">omega2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">simplify</span><span class="p">(</span><span class="n">Esq</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle E_{1}^{2} e^{2 i k_{1} z - 2 i \omega_{1} t} + 2 E_{1} E_{2} e^{i k_{1} z + i k_{2} z - i \omega_{1} t - i \omega_{2} t} + 2 E_{1} E_{3} e^{i k_{1} z + i k_{3} z - 2 i \omega_{1} t - i \omega_{2} t} + 2 E_{1} e^{i k_{1} z - i k_{3} z + i \omega_{2} t} \overline{E_{3}} + 2 E_{1} e^{i k_{1} z - i k_{2} z - i \omega_{1} t + i \omega_{2} t} \overline{E_{2}} + 2 E_{1} \overline{E_{1}} + E_{2}^{2} e^{2 i k_{2} z - 2 i \omega_{2} t} + 2 E_{2} E_{3} e^{i k_{2} z + i k_{3} z - i \omega_{1} t - 2 i \omega_{2} t} + 2 E_{2} e^{i k_{2} z - i k_{3} z + i \omega_{1} t} \overline{E_{3}} + 2 E_{2} e^{- i k_{1} z + i k_{2} z + i \omega_{1} t - i \omega_{2} t} \overline{E_{1}} + 2 E_{2} \overline{E_{2}} + E_{3}^{2} e^{2 i k_{3} z - 2 i \omega_{1} t - 2 i \omega_{2} t} + 2 E_{3} e^{- i k_{1} z + i k_{3} z - i \omega_{2} t} \overline{E_{1}} + 2 E_{3} e^{- i k_{2} z + i k_{3} z - i \omega_{1} t} \overline{E_{2}} + 2 E_{3} \overline{E_{3}} + e^{- 2 i k_{1} z + 2 i \omega_{1} t} \overline{E_{1}}^{2} + e^{- 2 i k_{2} z + 2 i \omega_{2} t} \overline{E_{2}}^{2} + e^{- 2 i k_{3} z + 2 i \omega_{1} t + 2 i \omega_{2} t} \overline{E_{3}}^{2} + 2 e^{- i k_{1} z - i k_{2} z + i \omega_{1} t + i \omega_{2} t} \overline{E_{1}} \overline{E_{2}} + 2 e^{- i k_{1} z - i k_{3} z + 2 i \omega_{1} t + i \omega_{2} t} \overline{E_{1}} \overline{E_{3}} + 2 e^{- i k_{2} z - i k_{3} z + i \omega_{1} t + 2 i \omega_{2} t} \overline{E_{2}} \overline{E_{3}}\]</div>
</div>
</div>
<p>There are lots of terms here, most of which we have identified in previous notebooks.  We look for terms in three categories:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\tilde{P}^{(NL)}_3\)</span> terms that oscillate at <span class="math notranslate nohighlight">\(\omega_3 = \omega_1 + \omega_2\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{P}^{(NL)}_2\)</span> terms that oscillate at <span class="math notranslate nohighlight">\(\omega_2 = \omega_3 - \omega_1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{P}^{(NL)}_1\)</span> terms that oscillate at <span class="math notranslate nohighlight">\(\omega_1 = \omega_3 - \omega_2\)</span>.</p></li>
</ol>
<p>We ignore the rest of terms, assuming that we have experimentally only phase-matched these three-wave mixing terms. By inspecting each term, we identify</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\tilde{P}^{(NL)}_3 = 2\epsilon_0\chi^{(2)}E_1E_2e^{j(k_1+k_2-k_3)} \\
\tilde{P}^{(NL)}_2 = 2\epsilon_0\chi^{(2)}E_3E^*_1e^{j(k_3-k_1-k_2)} \\
\tilde{P}^{(NL)}_1 = 2\epsilon_0\chi^{(2)}E_3E^*_2e^{j(k_3-k_2-k_1)} 
\end{align}
\end{split}\]</div>
<p>Notice there is a pattern that corresponds to the energy level diagram for each term.  After a little experience, you can actually just write down these terms by considering the possible energy level diagrams that lead to three-wave mixing.  We can now plug these nonlinear polarizations directly into the wave equation and produce 3 coupled differential equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{\partial E_3(z)}{\partial z}  &amp;= j\frac{\omega_3}{c n_3} \chi^{(2)}E_1E_2e^{-j\Delta k} \\
\frac{\partial E_2(z)}{\partial z}  &amp;= j\frac{\omega_2}{c n_2} \chi^{(2)}E_3E^*_1e^{j\Delta k} \\
\frac{\partial E_1(z)}{\partial z}  &amp;= j\frac{\omega_1}{c n_1} \chi^{(2)}E_3E^*_2e^{j\Delta k}
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta k = k_3 - k_2 - k_1\)</span>.</p>
</section>
<section id="exercises">
<h2><span class="section-number">5.2. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(20 pts) Describe the pattern in each of the coupled wave equations and how it relates to the energy level diagram for each process.</p></li>
</ol>
</section>
<section id="general-3-wave-mixing">
<h2><span class="section-number">5.3. </span>General 3-wave mixing<a class="headerlink" href="#general-3-wave-mixing" title="Permalink to this headline">#</a></h2>
<p>In the following code, we numerically solve these three differential equations.  These can be used to predict sum-frequency generation, difference frequency generation, and any other three-wave mixing process. For concreteness, I have used a <span class="math notranslate nohighlight">\(\chi^{(2)}\)</span> of lithium niobate and lightwaves near the visible spectrum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">ipw</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">%</span><span class="k">matplotlib</span> widget


<span class="c1"># define coupled wave equation model.  Later this will be called by a ode solver.</span>
<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">Lcoh</span><span class="p">):</span>  
    <span class="n">E3</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">E1</span> <span class="o">=</span> <span class="n">E</span>  
    <span class="n">dk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">Lcoh</span>
    <span class="n">dE3dz</span> <span class="o">=</span> <span class="n">a3</span><span class="o">*</span><span class="n">E1</span><span class="o">*</span><span class="n">E2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
    <span class="n">dE2dz</span> <span class="o">=</span> <span class="n">a2</span><span class="o">*</span><span class="n">E3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
    <span class="n">dE1dz</span> <span class="o">=</span> <span class="n">a1</span><span class="o">*</span><span class="n">E3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
    <span class="n">dEdz</span> <span class="o">=</span> <span class="p">[</span><span class="n">dE3dz</span><span class="p">,</span> <span class="n">dE2dz</span><span class="p">,</span> <span class="n">dE1dz</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dEdz</span>


<span class="c1"># Wrap the ode solver in an update function for animating the plot</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">Lcoh</span> <span class="o">=</span> <span class="mf">5e-2</span><span class="p">,</span> <span class="n">E10</span> <span class="o">=</span> <span class="mf">3e4</span><span class="p">,</span> <span class="n">E20</span> <span class="o">=</span> <span class="mf">3e4</span><span class="p">,</span> <span class="n">E30</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">E0</span> <span class="o">=</span> <span class="p">[</span><span class="n">E30</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span> <span class="n">E20</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">,</span> <span class="n">E10</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">]</span> <span class="c1"># set initial field values</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">model</span><span class="p">,[</span><span class="n">z0</span><span class="p">,</span><span class="n">zf</span><span class="p">],</span> <span class="n">E0</span><span class="p">,</span> <span class="n">t_eval</span> <span class="o">=</span> <span class="n">z</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">Lcoh</span><span class="p">,))</span> <span class="c1">#ode solver </span>
    <span class="n">I3</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">n3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#get intensities</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">line0</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">I3</span><span class="p">)</span> <span class="c1">#update graph</span>
    <span class="n">line1</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">I2</span><span class="p">)</span>
    <span class="n">line2</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">I1</span><span class="p">)</span>


    
<span class="c1"># Create z array</span>
<span class="n">z0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zf</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1">#10 cm long crystal</span>
<span class="n">Nz</span> <span class="o">=</span> <span class="mi">1001</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">zf</span><span class="p">,</span> <span class="n">Nz</span><span class="p">)</span>

<span class="c1"># </span>
<span class="n">chi2</span> <span class="o">=</span> <span class="mf">60e-12</span> <span class="c1"># Highest lithium niobate value (from Boyd)</span>

<span class="n">omega1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">300e12</span> <span class="c1">#approx 1000 nm (infrared)</span>
<span class="n">omega2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">500e12</span> <span class="c1">#approx 600 nm (orange)</span>
<span class="n">omega3</span> <span class="o">=</span> <span class="n">omega1</span><span class="o">+</span><span class="n">omega2</span> <span class="c1">#approx 375 nm (violet)</span>

<span class="n">n1</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># need to put in refractive index for lithium niobate</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n3</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">a3</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">chi2</span><span class="o">*</span><span class="n">omega3</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">n3</span><span class="p">)</span>
<span class="n">a2</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">chi2</span><span class="o">*</span><span class="n">omega2</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">chi2</span><span class="o">*</span><span class="n">omega1</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">n1</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">dummy_I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">line0</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dummy_I</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$I_3$&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dummy_I</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$I_2$&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">line2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dummy_I</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$I_1$&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity [W/m$^2$]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z [m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1e5</span><span class="p">,</span> <span class="mf">5e6</span><span class="p">)</span>


<span class="n">ipw</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">Lcoh</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="n">E10</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">5e4</span><span class="p">,</span><span class="mf">1e3</span><span class="p">),</span> <span class="n">E20</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">5e4</span><span class="p">,</span><span class="mf">1e3</span><span class="p">),</span> <span class="n">E30</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5e4</span><span class="p">,</span><span class="mf">1e3</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">ipw</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="o">*</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;widget&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># define coupled wave equation model.  Later this will be called by a ode solver.</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">Lcoh</span><span class="p">):</span>  

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py:2369,</span> in <span class="ni">InteractiveShell.run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2367</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2368</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2369</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2370</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/magics/pylab.py:99,</span> in <span class="ni">PylabMagics.matplotlib</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available matplotlib backends: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">backends_list</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">99</span>     <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">enable_matplotlib</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_show_matplotlib_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3537,</span> in <span class="ni">InteractiveShell.enable_matplotlib</span><span class="nt">(self, gui)</span>
<span class="g g-Whitespace">   </span><span class="mi">3533</span>         <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: Cannot change to a different GUI toolkit: </span><span class="si">%s</span><span class="s1">.&#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">3534</span>                 <span class="s1">&#39; Using </span><span class="si">%s</span><span class="s1"> instead.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">3535</span>         <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">find_gui_and_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3537</span> <span class="n">pt</span><span class="o">.</span><span class="n">activate_matplotlib</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3538</span> <span class="n">configure_inline_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3540</span> <span class="c1"># Now we must activate the gui pylab wants to use, and fix %run to take</span>
<span class="g g-Whitespace">   </span><span class="mi">3541</span> <span class="c1"># plot updates into account</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/IPython/core/pylabtools.py:360,</span> in <span class="ni">activate_matplotlib</span><span class="nt">(backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="c1"># Due to circular imports, pyplot may be only partially initialised</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span> <span class="c1"># when this function runs.</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span> <span class="c1"># So avoid needing matplotlib attribute-lookup to access pyplot.</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="ne">--&gt; </span><span class="mi">360</span> <span class="n">plt</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="o">.</span><span class="n">_needmain</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span> <span class="c1"># We need to detect at runtime whether show() is called by the user.</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span> <span class="c1"># For this, we wrap it into a decorator which adds a &#39;called&#39; flag.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/matplotlib/pyplot.py:277,</span> in <span class="ni">switch_backend</span><span class="nt">(newbackend)</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span> <span class="c1"># Backends are implemented as modules, but &quot;inherit&quot; default method</span>
<span class="g g-Whitespace">    </span><span class="mi">271</span> <span class="c1"># implementations from backend_bases._Backend.  This is achieved by</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span> <span class="c1"># creating a &quot;class&quot; that inherits from backend_bases._Backend and whose</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span> <span class="c1"># body is filled with the module&#39;s globals.</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span> <span class="n">backend_name</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_backend_module_name</span><span class="p">(</span><span class="n">newbackend</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">277</span> <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>     <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span> <span class="n">required_framework</span> <span class="o">=</span> <span class="n">_get_required_interactive_framework</span><span class="p">(</span><span class="n">backend_mod</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/site-packages/matplotlib/pyplot.py:278,</span> in <span class="ni">switch_backend.&lt;locals&gt;.backend_mod</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span> <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">278</span>     <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.9/x64/lib/python3.10/importlib/__init__.py:126,</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>             <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>         <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">126</span> <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1050,</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1027,</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:992,</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:241,</span> in <span class="ni">_call_with_frames_removed</span><span class="nt">(f, *args, **kwds)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1050,</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1027,</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1004,</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;ipympl&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2><span class="section-number">5.4. </span>Exercises<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(40 pts Extra Credit) Table 1.5.3 on page 49 of Boyd gives values of nonlinear susceptibilities for several crystals.  Note that <span class="math notranslate nohighlight">\(d = \frac{1}{2}\chi^{(2)}\)</span> by convention.  Re-solve the differential equations using quartz instead of lithium niobate and plot the result.  Find initial values of the electric field for each wave that correspond to sum-frequency generation and difference frequency generation. How much larger does the field need to be in quartz than in lithium niobate to achieve the same response?</p></li>
<li><p>(20 pts) Suppose you need to order a lithium niobate crystal to perform sum frequency generation. You have two mode-locked lasers: one at <span class="math notranslate nohighlight">\(\omega_1 = 2\pi \times 300\)</span> THz that can produces a electric field of 30,000 V/m, and another at <span class="math notranslate nohighlight">\(\omega_2 = 2\pi\times\)</span> 500 THz can produce a electric of 10,000 V/m.  What is the minimum coherence length needed to produce light at 800 THz equal in intesity to the light at 500 Thz?  At this coherence length, how long should you ask the manufacturer to cut the crystal?</p></li>
</ol>
</section>
<section id="quasi-phase-matching">
<h2><span class="section-number">5.5. </span>Quasi Phase Matching<a class="headerlink" href="#quasi-phase-matching" title="Permalink to this headline">#</a></h2>
<p>When a nonlinear process is phase matched, it means that the polarization wave that in the nonlinear medium has the same wavelength as the optical wave you wish to produce.  When this happens, the electric field from the generated wave will always push atoms farther from equilibrium, increasing the amplitude of their motion.  This is analogous to a child on a swing.  If the parent pushes the child out of phase even a little bit, the eventually the pushes will be working to decrease the swing’s amplitude rather than increase it.</p>
<p>We can visualize this by plotting the polarization wave and the produced electric field in the medium:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">0.01</span> <span class="c1"># mean wave vector of polarization and electric field</span>
<span class="n">Lcoh</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># coherence length</span>
<span class="n">dk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">Lcoh</span> <span class="c1"># wave vector mismatch</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">k0</span><span class="o">-</span><span class="n">dk</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="c1">#polarization wave</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">k0</span><span class="o">+</span><span class="n">dk</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="c1">#electric field wave</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="c1"># resulting beat wave</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Polarization Wave&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Produced Electric Field&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$\cos \Delta k z$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>From this plot, we can visualize the polarization wave and produced electric field slipping 180 degrees out of phase after one coherence length.</p>
<p>In some situations it is not possible to achive phase matching (<span class="math notranslate nohighlight">\(\Delta k = 0)\)</span> for a particular nonlinear process or material,  but there is a clever trick called quasi phase matching that can help.  There are experimental techniques to reverse the sign of the nonlinearity in non-centrosymmetric materials at regular intervals.  This corresponds to inverting the potential well of the nucleus-electron mass spring system, so that the restoring force is suddenly flipped.  If the material is flipped this way once every coherence length, then the polarization wave and electric field repeatedly slip out of phase for a coherence length, and then slip back into phase for a coherence length. The experiemental technique to accomplish this is called periodic poling.</p>
<p>Mathematicaly, we can model this by assuming that the phase <span class="math notranslate nohighlight">\(\Delta k z\)</span> flips every time <span class="math notranslate nohighlight">\(z\)</span> increases by a coherence length.  Using Scipy signal package, we can define a square-wave function <span class="math notranslate nohighlight">\(p(z)\)</span> that goes between 1 and -1 every coherence length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">dk</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">p</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Include quasi phase matching</span>

<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">ipw</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">%</span><span class="k">matplotlib</span> widget

<span class="c1"># define coupled wave equation model.  Later this will be called by a ode solver.</span>
<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">Lcoh</span><span class="p">):</span>  
    <span class="n">E3</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">E1</span> <span class="o">=</span> <span class="n">E</span>  
    <span class="n">dk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">Lcoh</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">dk</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span><span class="c1">#periodically poling function</span>
    
    <span class="n">dE3dz</span> <span class="o">=</span> <span class="n">a3</span><span class="o">*</span><span class="n">E1</span><span class="o">*</span><span class="n">E2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
    <span class="n">dE2dz</span> <span class="o">=</span> <span class="n">a2</span><span class="o">*</span><span class="n">E3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
    <span class="n">dE1dz</span> <span class="o">=</span> <span class="n">a1</span><span class="o">*</span><span class="n">E3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dk</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
    <span class="n">dEdz</span> <span class="o">=</span> <span class="p">[</span><span class="n">dE3dz</span><span class="p">,</span> <span class="n">dE2dz</span><span class="p">,</span> <span class="n">dE1dz</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dEdz</span>


<span class="c1"># Wrap the ode solver in an update function for animating the plot</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">Lcoh</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">E10</span> <span class="o">=</span> <span class="mf">1.5e4</span><span class="p">,</span> <span class="n">E20</span> <span class="o">=</span> <span class="mf">1.5e4</span><span class="p">,</span> <span class="n">E30</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">E0</span> <span class="o">=</span> <span class="p">[</span><span class="n">E30</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span> <span class="n">E20</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">,</span> <span class="n">E10</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">]</span> <span class="c1"># set initial field values</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">model</span><span class="p">,[</span><span class="n">z0</span><span class="p">,</span><span class="n">zf</span><span class="p">],</span> <span class="n">E0</span><span class="p">,</span> <span class="n">t_eval</span> <span class="o">=</span> <span class="n">z</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">Lcoh</span><span class="p">,))</span> <span class="c1">#ode solver </span>
    <span class="n">I3</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">n3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#get intensities</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">epsilon_0</span><span class="o">*</span><span class="n">n1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">line0</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">I3</span><span class="p">)</span> <span class="c1">#update graph</span>
    <span class="n">line1</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">I2</span><span class="p">)</span>
    <span class="n">line2</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">I1</span><span class="p">)</span>


    
<span class="c1"># Create z array</span>
<span class="n">z0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zf</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1">#10 cm long crystal</span>
<span class="n">Nz</span> <span class="o">=</span> <span class="mi">1001</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">zf</span><span class="p">,</span> <span class="n">Nz</span><span class="p">)</span>

<span class="c1"># </span>
<span class="n">chi2</span> <span class="o">=</span> <span class="mf">60e-12</span> <span class="c1"># Highest lithium niobate value (from Boyd)</span>

<span class="n">omega1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">300e12</span> <span class="c1">#approx 1000 nm (infrared)</span>
<span class="n">omega2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">500e12</span> <span class="c1">#approx 600 nm (orange)</span>
<span class="n">omega3</span> <span class="o">=</span> <span class="n">omega1</span><span class="o">+</span><span class="n">omega2</span> <span class="c1">#approx 375 nm (violet)</span>

<span class="n">n1</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># need to put in refractive index for lithium niobate</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n3</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">a3</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">chi2</span><span class="o">*</span><span class="n">omega3</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">n3</span><span class="p">)</span>
<span class="n">a2</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">chi2</span><span class="o">*</span><span class="n">omega2</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">chi2</span><span class="o">*</span><span class="n">omega1</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">n1</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">dummy_I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">line0</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dummy_I</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$I_3$&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dummy_I</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$I_2$&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">line2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dummy_I</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$I_1$&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity [W/m$^2$]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z [m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1e5</span><span class="p">,</span> <span class="mf">5e6</span><span class="p">)</span>


<span class="n">ipw</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">Lcoh</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="n">E10</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">5e4</span><span class="p">,</span><span class="mf">1e3</span><span class="p">),</span> <span class="n">E20</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">5e4</span><span class="p">,</span><span class="mf">1e3</span><span class="p">),</span> <span class="n">E30</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5e4</span><span class="p">,</span><span class="mf">1e3</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2><span class="section-number">5.6. </span>Exercises<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(60 pts) Design a simulation in which you allow the period of the poling to not exactly match the coherence length.  In other words, <span class="math notranslate nohighlight">\(L_{pole} = 2 \eta L_{coh}\)</span>, where <span class="math notranslate nohighlight">\(\eta\)</span> is a number close to 1.  For what values of <span class="math notranslate nohighlight">\(\eta\)</span> do you notice an appreciable loss in conversion efficiency?  Does this depend on the input powers of the lasers, and the length of the crystal relative to the coherence length?</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="4.%20Coupled%20Wave%20Equations.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4. </span>Coupled Wave Equations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="6.%20Focused%20Beams.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Focused Beams</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr. Ryan Camacho<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>