
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>19. The Density Matrix &#8212; Nonlinear Optics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="20. First Order Perturbation Theory" href="20.%20First%20Order%20Perturbation%20Theory.html" />
    <link rel="prev" title="18. The Quantum Mechanical Wave Function" href="18.%20The%20Quantum%20Mechanical%20Wave%20Function.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Nonlinear Optics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Nonlinear Optics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Course Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../schedule.html">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer.html">
   Computer Configuration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1.%20Atomic%20Polarizability.html">
   1. Atoms in external electric fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.%20The%20Nonlinear%20Susceptibility.html">
   2. The Nonlinear Susceptibility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3.%20Overview%20of%20Nonlinear%20Processes.html">
   3. Overview of Nonlinear Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4.%20Coupled%20Wave%20Equations.html">
   4. Coupled Wave Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5.%20Three-Wave%20Mixing.html">
   5. Three-Wave Mixing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6.%20Focused%20Beams.html">
   6. Focused Beams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7.%20Crystal%20Symmetry.html">
   7. Crystal Symmetry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8.%20Nonlinear%20Optics%20in%20Crystals.html">
   8. Nonlinear Optics in Crystals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9.%20Third%20Order%20Nonlinear%20Polarization.html">
   9. Third-order nonlinear polarization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.%20Raman%20Scattering.html">
   10. Introduction to Raman Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.%20Optoacoustic%20Effects.html">
   11. Optoacoustic Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.%20Stimulated%20Brillouin%20Scattering.html">
   12. Stimulated Brillouin Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.%20Optical%20Phase%20Conjugation.html">
   13. Optical Phase Conjugation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.%20Phase%20and%20Group%20Velocities.html">
   14. Phase and Group Velocities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15.%20Dispersion%20in%20Optical%20Pulses.html">
   15. Dispersion in Optical Pulses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.%20Nonlinear%20Differential%20Equations%20for%20Pulsed%20Light.html">
   16. Nonlinear Differential Equations For Pulsed Light
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.%20Combining%20Dispersion%20and%20Nonlinearity%20in%20Optical%20Pulse%20Propagation.html">
   17. Combining Dispersion and Nonlinearity in Optical Pulse Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.%20The%20Quantum%20Mechanical%20Wave%20Function.html">
   18. The Quantum Mechanical Wave Function
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   19. The Density Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20.%20First%20Order%20Perturbation%20Theory.html">
   20. First Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="21.%20Second%20Order%20Perturbation%20Theory.html">
   21. Second Order Perturbation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22.%20Electromagnetically%20Induced%20Transparency.html">
   22. Electromagnetically Induced Transparency
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/BYUCamachoLab/nonlinear-optics/main?urlpath=tree/book/pages/19. The Density Matrix.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/BYUCamachoLab/nonlinear-optics/blob/main/book/pages/19. The Density Matrix.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/BYUCamachoLab/nonlinear-optics/issues/new?title=Issue%20on%20page%20%2Fpages/19. The Density Matrix.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/pages/19. The Density Matrix.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#name">
   19.1. Name:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#total-points-100-pts">
   19.2. Total Points: –/100 pts
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review">
   19.3. Review
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   19.4. The Density Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-level-atom">
   19.5. Two Level Atom
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   19.6. Example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   19.7. Exercises
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The Density Matrix</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#name">
   19.1. Name:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#total-points-100-pts">
   19.2. Total Points: –/100 pts
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review">
   19.3. Review
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   19.4. The Density Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-level-atom">
   19.5. Two Level Atom
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   19.6. Example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   19.7. Exercises
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="the-density-matrix">
<h1><span class="section-number">19. </span>The Density Matrix<a class="headerlink" href="#the-density-matrix" title="Permalink to this headline">#</a></h1>
<section id="name">
<h2><span class="section-number">19.1. </span>Name:<a class="headerlink" href="#name" title="Permalink to this headline">#</a></h2>
</section>
<section id="total-points-100-pts">
<h2><span class="section-number">19.2. </span>Total Points: –/100 pts<a class="headerlink" href="#total-points-100-pts" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### UNCOMMENT AND RUN THIS CELL IF USING GOOGLE COLAB</span>
<span class="c1"># !pip install ipympl -q</span>
<span class="c1"># from google.colab import output</span>
<span class="c1"># output.enable_custom_widget_manager()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="review">
<h2><span class="section-number">19.3. </span>Review<a class="headerlink" href="#review" title="Permalink to this headline">#</a></h2>
<p>In the last notebook, we arrived at the equation of motion for the stationary states that make up a wavefunction.  To summarize,  if  the wavefunction is</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\Psi(r,t) = \sum_nb_n|n\rangle e^{-j\omega_n t}
\end{align}
\]</div>
<p>and the Hamiltonian is</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\hat{H} = \hat{H_0} + V
\end{align}
\]</div>
<p>then the equation of motion for the <span class="math notranslate nohighlight">\(b\)</span> coefficients is</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\dot{b}_n = -\frac{j}{\hbar}\sum_l V_{nl}e^{j\omega_{nl}t} b_l
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(V_{ln} = \langle n|\hat{V}|l \rangle\)</span> is the perturbation matrix element.</p>
<p>We noted that for nonlinear optics, we ar most interested in wavefunctions of electron clouds around atoms.  In this case the perturbing Hamiltonian <span class="math notranslate nohighlight">\(V\)</span> accounts for the slight polarization of the atom when an external field is applied:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\hat{V} = e\hat{\mathbf{r}}\cdot{\mathbf{E}} &amp;= -\hat{\mathbf{\mu}}\cdot\mathbf{E}
\end{align}
\]</div>
<p>Here’s the explicit derivation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{\partial |\Psi \rangle}{\partial t} &amp;= \frac{-j}{\hbar}\hat{H} | \Psi \rangle  \\
\frac{\partial}{\partial t}\sum_nb_n|n\rangle e^{-j\omega_n t}&amp;= \frac{-j}{\hbar} \left(\hat{H_0} + V \right ) \sum_nb_n|n\rangle e^{-j\omega_n t}  \\
\sum_n \left ( \dot{b}_n -j\omega_n b_n \right)|n\rangle e^{-j\omega_n t}&amp;=  \sum_n -j\omega_n b_n |n\rangle e^{-j\omega_n t} - \frac{j}{\hbar} V \sum_nb_n|n\rangle e^{-j\omega_n t}  \\
\sum_n  \dot{b}_n|n\rangle e^{-j\omega_n t}&amp;=  - \frac{j}{\hbar} V\ \sum_nb_n|n\rangle e^{-j\omega_n t}  \\
\end{align}
\end{split}\]</div>
<p>Projecting both sides onto a state <span class="math notranslate nohighlight">\(\langle l |e^{j\omega_l t}\)</span> we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\langle l |e^{-j\omega_l t} \sum_n  \dot{b}_n|n\rangle e^{-j\omega_n t}&amp;=  - \frac{j}{\hbar} \langle l |e^{j\omega_l t} V \sum_nb_n|n\rangle e^{-j\omega_n t}  \\
 \sum_n  \dot{b}_n \langle l |n\rangle e^{-j(\omega_n-\omega_l) t}&amp;=  - \frac{j}{\hbar} \sum_nb_n \langle l|V|n\rangle e^{-j(\omega_n-\omega_l) t}  \\
 \dot{b}_n &amp;= -\frac{j}{\hbar}\sum_l V_{nl}e^{j\omega_{nl}t} b_l 
\end{align}
\end{split}\]</div>
<p>where in the last step we have used the fact that the stationary states are orthogonal:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\langle l | n \rangle = \int_\mathbf{r} \psi_l^*(r) \psi_n(r)d\mathbf{r} = \delta_{nl}
\end{align}
\]</div>
<p>Let’s explore what this rate equation is telling us. We can think of it this way:  When the perturbation part of the Hamiltonion <span class="math notranslate nohighlight">\(V\)</span> operates on the wavefunction <span class="math notranslate nohighlight">\(\psi\)</span>, it modifies each of the stationary states that make up the “bare” wavefunctions.  Each of the bare states are now in a superposition of the other bare states, with <span class="math notranslate nohighlight">\(V_{nl}\)</span> telling us how much of the state <span class="math notranslate nohighlight">\(|n\rangle\)</span> is mapped onto the state <span class="math notranslate nohighlight">\(|l \rangle\)</span> by the perturbation <span class="math notranslate nohighlight">\(V\)</span>. But the new state <span class="math notranslate nohighlight">\(|l\rangle\)</span> has a <em>different</em> time evolution <span class="math notranslate nohighlight">\(e^{-j\omega_l t}\)</span>, so as the state evolves, the result of a small perturbation can actually result in a large re-mapping in the original state into the other stationary states over time.  Does this sound like what we’ve been studying in nonlinear optics?  I hope so!</p>
</section>
<section id="id1">
<h2><span class="section-number">19.4. </span>The Density Matrix<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>When treating nonlinear optics phenomena with the machinery of quantum mechanics, there are significant advantages to employing what is called the “density operator”.  We already know that state vector <span class="math notranslate nohighlight">\(|\psi \rangle\)</span> can be written as a superpostion of the stationary states:  <span class="math notranslate nohighlight">\(| \psi \rangle = \sum_n b_n |n \rangle\)</span>.  Consider now an operator <span class="math notranslate nohighlight">\(\hat{\rho}\)</span>, which we’ll call the density matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\hat{\rho} &amp;= |\psi \rangle \langle \psi |  \\
     &amp; = \left(\sum_m b_m |m\rangle \right) \left( \sum_n b_n^*\langle n | \right )
\end{align}
\end{split}\]</div>
<p>To get a better feeling for this, let’s write it our in matrix form.  Our state vectors can be written:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
|\psi\rangle =
\begin{bmatrix}
b_0 \\
b_1 \\
b_2 \\
\vdots\\
b_N \\
\end{bmatrix}  \\
\end{align}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
\begin{align}
\langle \psi | =
\begin{bmatrix}
b_0^* &amp; b_1^* &amp; b_2^* &amp; \cdots &amp; b_N^*
\end{bmatrix}
\end{align}
\]</div>
<p>Which makes our density matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\hat{\rho} = |\psi \rangle \langle \psi | &amp;= 
\begin{bmatrix}
b_0^* &amp; b_1^* &amp; b_2^* &amp; \cdots &amp; b_N^*
\end{bmatrix}
\begin{bmatrix}
b_0 \\
b_1 \\
b_2 \\
\vdots\\
b_N \\
\end{bmatrix}  \\ &amp;= 
\begin{bmatrix}
b_0b_0^* &amp; b_0b_1^* &amp; b_0b_2^* &amp; \cdots &amp; b_0b_N^* \\
b_1b_0^* &amp; b_1b_1^* &amp; b_1b_2^* &amp; \cdots &amp; b_1b_N^* \\
b_2b_0^* &amp; b_2b_1^* &amp; b_2b_2^* &amp; \cdots &amp; b_2b_N^* \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
b_Nb_0^* &amp; b_Nb_1^* &amp; b_Nb_2^* &amp; \cdots &amp; b_Nb_N^* \\
\end{bmatrix}
\end{align}
\end{split}\]</div>
<p>The density matrix contains the same exact information as the state vector itself–no more and no less.  In fact, starting with the Schrodinger equation, we can write down the time evolution of the density matrix:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\frac{\partial \hat{\rho}}{\partial t} = \frac{-j}{\hbar}[\hat{H}, \hat{\rho}]
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\([\hat{H}, \hat{\rho}] = \hat{H} \hat{\rho} - \hat{\rho} \hat{H} \)</span> is the commutator of <span class="math notranslate nohighlight">\(\hat{H}\)</span> and <span class="math notranslate nohighlight">\(\hat{\rho}\)</span>.  This equation contains the identical information as the Schrodinger equation.</p>
<p>Each element <span class="math notranslate nohighlight">\(\rho_{mn}\)</span> of the density matrix may be written</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\rho_{nm} = \langle n |\hat{\rho} | m \rangle = b_n b_m^*
\end{align}
\]</div>
<p>Take a look at the diagonal elements of <span class="math notranslate nohighlight">\(\hat{\rho}\)</span>. They are of the form <span class="math notranslate nohighlight">\(b_nb_n^* = |b_n|^2\)</span>.  This is just the probability of finding the wavevector in state <span class="math notranslate nohighlight">\(|n\rangle\)</span>. Since all the probabilities must add up to 1, the sum of the diagonal elements of <span class="math notranslate nohighlight">\(\hat{\rho}\)</span>, also called the trace of <span class="math notranslate nohighlight">\(\hat{\rho}\)</span> must be 1.</p>
</section>
<section id="two-level-atom">
<h2><span class="section-number">19.5. </span>Two Level Atom<a class="headerlink" href="#two-level-atom" title="Permalink to this headline">#</a></h2>
<p>To explore how to use the density matrix, let’s consider the simplest possible system:  an atom with just two states. In this case we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\hat{\rho} = 
\begin{bmatrix}
|b_0|^2 &amp; b_0b_1^* \\
b_1b_0^* &amp; |b_1|^2 \\
\end{bmatrix}
\end{align}
\end{split}\]</div>
<p>Again, the diagonal elements represent the probability of find the atom in that state.  It turns out the off-diagonal elements represent the polarization of the atom, but we’ll save that for a minute.  First, let’s practice putting the atom in the ground state but setting <span class="math notranslate nohighlight">\(b_0 = 1\)</span> and <span class="math notranslate nohighlight">\(b_1 = 0\)</span>.  Our density matrix becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\hat{\rho}_{ground} = 
\begin{bmatrix}
1 &amp; 0 \\
0 &amp; 0 \\
\end{bmatrix}
\end{align}
\end{split}\]</div>
<p>Ok, in order find the time evolution of the state vector probabilities we need to find the commutator <span class="math notranslate nohighlight">\([\hat{H}, \hat{\rho}]\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
[\hat{H}_0 + V, \hat{\rho}] &amp;= \hat{H}_0\hat{\rho} -  \hat{\rho}\hat{H}_0 + V\hat{\rho} -  \hat{\rho}V \\
                            &amp;= \hat{H}_0|\psi \rangle \langle \psi | - |\psi \rangle \langle \psi |\hat{H}_0
                            + V|\psi \rangle \langle \psi -  |\psi \rangle \langle \psi| V \\
\end{align}
\end{split}\]</div>
<p>We can write this in matrix form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
[\hat{H}, \hat{\rho}] &amp;= 
\begin{bmatrix}
E_0|b_0|^2 &amp; E_0b_0b_1^* \\
E_1b_1b_0^* &amp; E_1|b_1|^2 \\ 
\end{bmatrix} - 
\begin{bmatrix}
E_0|b_0|^2 &amp; E_1b_0b_1^* \\
E_0b_1b_0^* &amp; E_1|b_1|^2 \\ 
\end{bmatrix} + 
\begin{bmatrix}
V_{11} &amp; V_{12} \\
V_{21} &amp; V_{22} \\ 
\end{bmatrix}
\begin{bmatrix}
|b_0|^2 &amp; b_0b_1^* \\
b_1b_0^* &amp; |b_1|^2 \\ 
\end{bmatrix} - 
\begin{bmatrix}
|b_0|^2 &amp; b_0b_1^* \\
b_1b_0^* &amp; |b_1|^2 \\ 
\end{bmatrix}
\begin{bmatrix}
V_{11} &amp; V_{12} \\
V_{21} &amp; V_{22} \\ 
\end{bmatrix}\\ &amp;= 
\begin{bmatrix}
0 &amp; (E_0 - E_1)b_0b_1^* \\
(E_1-E_0)b_1b_0^* &amp; 0 \\ 
\end{bmatrix} + 
\begin{bmatrix}
V_{11} &amp; V_{12} \\
V_{21} &amp; V_{22} \\ 
\end{bmatrix}
\begin{bmatrix}
|b_0|^2 &amp; b_0b_1^* \\
b_1b_0^* &amp; |b_1|^2 \\ 
\end{bmatrix} - 
\begin{bmatrix}
|b_0|^2 &amp; b_0b_1^* \\
b_1b_0^* &amp; |b_1|^2 \\ 
\end{bmatrix}
\begin{bmatrix}
V_{11} &amp; V_{12} \\
V_{21} &amp; V_{22} \\ 
\end{bmatrix}
\end{align}
\end{split}\]</div>
<p>Using the definition of matrix multiplication, we can find the time derivative of any element of the density matrix to be:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\dot{\rho}_{mn} = -j\omega_{mn}\rho_{mn} - \frac{j}{\hbar}\sum_q\left(V_{mq}\rho_{qn} - \rho_{mq}V_{qn} \right)
\end{align}
\]</div>
<p>Since the rule for matrix multiplication doesn’t depend on the size the of the matrices, this is actually a general result.</p>
</section>
<section id="example">
<h2><span class="section-number">19.6. </span>Example<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h2>
<p>Let’s consider again the Hydrogen atom, but let’s assume for a moment that it only has two levels <span class="math notranslate nohighlight">\(\psi_{100}\)</span> and <span class="math notranslate nohighlight">\(\psi_{200}\)</span> and that there is no perturbation to these levels (<span class="math notranslate nohighlight">\(V=0\)</span>).  Now let’s put it in the superposition state</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\Psi(r,t) &amp;= \frac{\psi_{100}e^{\frac{-j}{\hbar}E_1 t} + \psi_{200}e^{\frac{-j}{\hbar}E_2 t}}{\sqrt{2}} =
\frac{1}{\sqrt{2}}\begin{bmatrix} 
e^{-j\omega_1 t} \\
e^{-j\omega_2 t} \\
\end{bmatrix}
\end{align}
\end{split}\]</div>
<p>and write down the density matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\hat{\rho} &amp;= |\Psi \rangle \langle \Psi |  \\
     &amp;  = 
\begin{bmatrix}
\frac{1}{2}e^{-j\omega_1 t} &amp; \frac{1}{2}e^{-j\omega_{12} t} \\
\frac{1}{2}e^{j\omega_{12} t} &amp; \frac{1}{2}e^{-j\omega_{2} t} \\
\end{bmatrix}
\end{align}
\end{split}\]</div>
<p>We take the time derivative to find</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{\partial \hat{\rho}}{\partial t} = 
\begin{bmatrix}
\frac{-j\omega_1}{2}e^{-j\omega_1 t} &amp; \frac{-j\omega_{12}}{2}e^{-j\omega_{12} t} \\
\frac{j\omega_{12}}{2}e^{j\omega_{12} t} &amp; \frac{-j\omega_2}{2}e^{-j\omega_{2} t} \\
\end{bmatrix}
\end{align}
\end{split}\]</div>
<p>and we can verify that it follows the time evolution equation we derived.</p>
</section>
<section id="exercises">
<h2><span class="section-number">19.7. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>(30 pts) For the superposition state considered in this example, plot the time evolution of the probability of finding the atom in the ground state and the excited state.  Use <span class="math notranslate nohighlight">\(\omega_1 = 13.6\)</span> and <span class="math notranslate nohighlight">\(\omega_2 = 13.6/4\)</span>.</p></li>
<li><p>(20 pts)Now treat all four elements of the density matrix as complex numbers <span class="math notranslate nohighlight">\(x(t) + jp(t)\)</span> and plot them in the complex plane with <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span> as the coordinate axes.</p></li>
<li><p>(10 pts) Check that <span class="math notranslate nohighlight">\(r^2 = x^2 + y^2\)</span> corresponds to the probabilities you found in part (1).</p></li>
<li><p>(10 pts) Some people call the off diagonal elements the “coherence” between two states.  Does your plot in the complex plane give any insight into what the off-diagonal elements may be describing?</p></li>
<li><p>(30 pts) Add a very small perturbation
$<span class="math notranslate nohighlight">\(\begin{align}
 V = 
 \begin{bmatrix}
 0 &amp; V_{12} \\
 V_{21} &amp; 0
 \end{bmatrix}
 \end{align}\)</span><span class="math notranslate nohighlight">\(
 where \)</span>V_{12} = V_{21}<span class="math notranslate nohighlight">\( is a variable that you can adjust.  Since \)</span>E_n = \hbar\omega_n<span class="math notranslate nohighlight">\(, try making \)</span>V_{12}<span class="math notranslate nohighlight">\( a fraction of this number, and setting \)</span>\hbar = 1$.  Plot the new time evolution of the density matrix elements and the state populations.</p></li>
</ol>
<p>It is often much more convenient to define a new density matrix <span class="math notranslate nohighlight">\(\sigma\)</span> such that every element is modified according to</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\sigma_{mn} = \rho_{mn}e^{j\omega_{mn}t}
\end{align}
\]</div>
<p>This takes away the natural time dependence of the bare states and justs looks at the effect of the oscillations induced by the perturbations.  Plot the elements of <span class="math notranslate nohighlight">\(\sigma\)</span> and the state populations.  Animate your plot so that you can adjust <span class="math notranslate nohighlight">\(V_{12}\)</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="18.%20The%20Quantum%20Mechanical%20Wave%20Function.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">18. </span>The Quantum Mechanical Wave Function</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="20.%20First%20Order%20Perturbation%20Theory.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">20. </span>First Order Perturbation Theory</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr. Ryan Camacho<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>